<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lean Flow Master - –ë–µ—Ä–µ–∂–ª–∏–≤–æ–µ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ –∏ ITIL 4</title>
    <link href="https://fonts.googleapis.com/css2?family=Russo+One&family=Exo+2:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-dark: #0d1117; --bg-card: #161b22; --bg-column: #21262d;
            --text-primary: #c9d1d9; --text-secondary: #8b949e;
            --accent-green: #238636; --accent-blue: #1f6feb; --accent-purple: #8957e5;
            --accent-orange: #d29922; --accent-red: #da3633; --accent-cyan: #39c5cf;
            --waste-transport: #f97316; --waste-inventory: #8b5cf6; --waste-motion: #ec4899;
            --waste-waiting: #f59e0b; --waste-overprod: #ef4444; --waste-overproc: #6366f1;
            --waste-defects: #dc2626; --waste-talent: #14b8a6;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Exo 2', sans-serif; background: var(--bg-dark); color: var(--text-primary); min-height: 100vh; }
        
        .app { display: flex; flex-direction: column; height: 100vh; }
        
        /* Header */
        .header { background: var(--bg-card); padding: 15px 25px; display: flex; justify-content: space-between; align-items: center;
            border-bottom: 1px solid rgba(255,255,255,0.1); }
        .logo { display: flex; align-items: center; gap: 15px; }
        .logo-icon { font-size: 2em; }
        .logo-text { font-family: 'Russo One', sans-serif; font-size: 1.5em;
            background: linear-gradient(135deg, var(--accent-green), var(--accent-cyan));
            -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .logo-sub { font-size: 0.8em; color: var(--text-secondary); }
        
        .stats { display: flex; gap: 20px; }
        .stat { background: var(--bg-column); padding: 10px 20px; border-radius: 10px; text-align: center; }
        .stat-value { font-size: 1.5em; font-weight: 700; }
        .stat-label { font-size: 0.75em; color: var(--text-secondary); }
        .stat-efficiency .stat-value { color: var(--accent-green); }
        .stat-waste .stat-value { color: var(--accent-red); }
        .stat-score .stat-value { color: var(--accent-cyan); }
        .stat-time .stat-value { color: var(--accent-orange); }
        
        .controls { display: flex; gap: 10px; }
        .btn { padding: 10px 20px; border: none; border-radius: 8px; font-family: 'Exo 2', sans-serif;
            font-weight: 600; cursor: pointer; transition: all 0.3s; display: flex; align-items: center; gap: 8px; }
        .btn:hover { transform: translateY(-2px); }
        .btn:disabled { opacity: 0.4; cursor: not-allowed; filter: grayscale(50%); }
        .btn-start { background: var(--accent-green); color: white; }
        .btn-rules { background: var(--accent-purple); color: white; }
        .btn-reset { background: var(--accent-red); color: white; }
        
        #nextDayBtn:not(:disabled) {
            animation: btnPulse 2s infinite;
        }
        
        @keyframes btnPulse {
            0%, 100% {
                box-shadow: 0 0 0 0 rgba(57, 197, 207, 0.7);
            }
            50% {
                box-shadow: 0 0 0 10px rgba(57, 197, 207, 0);
            }
        }
        
        /* Main Area */
        .main { display: flex; flex: 1; overflow: hidden; }
        
        /* Kanban Board */
        .kanban { flex: 1; display: flex; gap: 15px; padding: 20px; overflow-x: auto; }
        .column { background: var(--bg-column); border-radius: 12px; min-width: 280px; max-width: 280px;
            display: flex; flex-direction: column; position: relative; }
        .column.automated { 
            background: linear-gradient(135deg, var(--bg-column) 0%, rgba(137,87,229,0.15) 100%);
            border: 2px solid var(--accent-purple);
        }
        .column.automated::before {
            content: 'ü§ñ –ê–≤—Ç–æ';
            position: absolute;
            top: 5px;
            right: 5px;
            background: var(--accent-purple);
            color: white;
            padding: 3px 8px;
            border-radius: 5px;
            font-size: 0.7em;
            font-weight: 600;
            z-index: 10;
        }
        .column-header { padding: 15px; border-bottom: 1px solid rgba(255,255,255,0.1);
            display: flex; justify-content: space-between; align-items: center; }
        .column-title { font-weight: 600; display: flex; align-items: center; gap: 8px; }
        .column-count { background: rgba(255,255,255,0.1); padding: 2px 8px; border-radius: 10px; font-size: 0.8em; }
        .column-wip { font-size: 0.75em; color: var(--text-secondary); }
        .column-wip.exceeded { color: var(--accent-red); font-weight: 600; }
        .column-wip.kaizen { color: var(--accent-cyan); font-weight: 600; }
        .column-body { flex: 1; padding: 10px; overflow-y: auto; min-height: 200px; }
        
        /* Cards */
        .card { background: var(--bg-card); border-radius: 8px; padding: 12px; margin-bottom: 10px;
            border: 2px solid transparent; cursor: pointer; transition: all 0.3s; position: relative; }
        .card:hover { border-color: var(--accent-blue); transform: translateY(-2px); }
        .card.selected { border-color: var(--accent-cyan); box-shadow: 0 0 20px rgba(57,197,207,0.3); }
        .card.has-waste { border-color: var(--accent-orange); }
        .card.blocked { opacity: 0.6; border-color: var(--accent-red); }
        .card-id { font-size: 0.7em; color: var(--text-secondary); margin-bottom: 5px; }
        .card-title { font-weight: 600; font-size: 0.9em; margin-bottom: 8px; }
        .card-type { display: inline-block; padding: 2px 8px; border-radius: 4px; font-size: 0.7em; font-weight: 600; }
        .type-feature { background: rgba(31,111,235,0.2); color: var(--accent-blue); }
        .type-bug { background: rgba(218,54,51,0.2); color: var(--accent-red); }
        .type-improvement { background: rgba(35,134,54,0.2); color: var(--accent-green); }
        .type-request { background: rgba(137,87,229,0.2); color: var(--accent-purple); }
        .card-footer { display: flex; justify-content: space-between; align-items: center; margin-top: 10px; gap: 8px; }
        .card-value { font-size: 0.75em; color: var(--accent-green); font-weight: 600; }
        .card-effort { font-size: 0.75em; font-weight: 600; }
        .card-time { font-size: 0.75em; color: var(--text-secondary); }
        .card-waste-indicator { position: absolute; top: 8px; right: 8px; font-size: 1em; animation: pulse 2s infinite; }
        @keyframes pulse { 0%,100% { opacity: 1; } 50% { opacity: 0.5; } }
        
        /* Waste Badge */
        .waste-badge { display: inline-flex; align-items: center; gap: 4px; padding: 3px 8px;
            border-radius: 4px; font-size: 0.65em; font-weight: 600; margin-top: 8px; }
        .waste-transport { background: rgba(249,115,22,0.2); color: var(--waste-transport); }
        .waste-inventory { background: rgba(139,92,246,0.2); color: var(--waste-inventory); }
        .waste-motion { background: rgba(236,72,153,0.2); color: var(--waste-motion); }
        .waste-waiting { background: rgba(245,158,11,0.2); color: var(--waste-waiting); }
        .waste-overprod { background: rgba(239,68,68,0.2); color: var(--waste-overprod); }
        .waste-overproc { background: rgba(99,102,241,0.2); color: var(--waste-overproc); }
        .waste-defects { background: rgba(220,38,38,0.2); color: var(--waste-defects); }
        .waste-talent { background: rgba(20,184,166,0.2); color: var(--waste-talent); }
        
        /* Side Panel */
        .side-panel { width: 320px; background: var(--bg-card); border-left: 1px solid rgba(255,255,255,0.1);
            display: flex; flex-direction: column; }
        .panel-section { padding: 15px; border-bottom: 1px solid rgba(255,255,255,0.1); }
        .panel-title { font-family: 'Russo One', sans-serif; font-size: 1em; margin-bottom: 12px;
            display: flex; align-items: center; gap: 8px; }
        
        /* Actions */
        .action-btn { width: 100%; padding: 12px; margin-bottom: 8px; border: none; border-radius: 8px;
            font-family: 'Exo 2', sans-serif; font-weight: 600; cursor: pointer; transition: all 0.3s;
            display: flex; align-items: center; gap: 10px; text-align: left; }
        .action-btn:disabled { opacity: 0.4; cursor: not-allowed; }
        .action-btn:not(:disabled):hover { transform: translateX(5px); }
        .action-btn .icon { font-size: 1.2em; }
        .action-btn .text { flex: 1; }
        .action-btn .cost { font-size: 0.8em; opacity: 0.7; }
        
        .btn-move { background: linear-gradient(135deg, var(--accent-blue), #2563eb); color: white; }
        .btn-eliminate { background: linear-gradient(135deg, var(--accent-green), #16a34a); color: white; }
        .btn-automate { background: linear-gradient(135deg, var(--accent-purple), #7c3aed); color: white; }
        .btn-kaizen { background: linear-gradient(135deg, var(--accent-cyan), #06b6d4); color: white; }
        .btn-5s { background: linear-gradient(135deg, var(--accent-orange), #ea580c); color: white; }
        
        /* Waste Legend */
        .waste-legend { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; }
        .legend-item { display: flex; align-items: center; gap: 6px; font-size: 0.75em; padding: 5px;
            background: rgba(255,255,255,0.03); border-radius: 5px; cursor: pointer; transition: all 0.2s; }
        .legend-item:hover { background: rgba(255,255,255,0.08); }
        .legend-dot { width: 10px; height: 10px; border-radius: 50%; }
        
        /* ITIL Connection */
        .itil-connection { background: rgba(31,111,235,0.1); border: 1px solid rgba(31,111,235,0.3);
            border-radius: 8px; padding: 12px; margin-top: 10px; }
        .itil-title { font-weight: 600; font-size: 0.85em; color: var(--accent-blue); margin-bottom: 5px; }
        .itil-text { font-size: 0.8em; color: var(--text-secondary); line-height: 1.5; }
        
        /* Log */
        .log { flex: 1; overflow-y: auto; padding: 10px; max-height: 200px; }
        .log-entry { font-size: 0.75em; padding: 5px 8px; margin-bottom: 4px; border-radius: 4px;
            background: rgba(255,255,255,0.03); border-left: 3px solid var(--text-secondary); }
        .log-entry.success { border-left-color: var(--accent-green); }
        .log-entry.warning { border-left-color: var(--accent-orange); }
        .log-entry.info { border-left-color: var(--accent-blue); }
        .log-entry.waste { border-left-color: var(--accent-red); }
        
        /* Modal */
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.85); z-index: 1000; }
        .modal-box { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
            background: var(--bg-card); border-radius: 16px; padding: 25px; width: 90%; max-width: 700px;
            max-height: 85vh; overflow-y: auto; border: 1px solid rgba(255,255,255,0.1); }
        .modal-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
        .modal-title { font-family: 'Russo One', sans-serif; font-size: 1.4em; }
        .modal-close { background: none; border: none; color: var(--text-secondary); font-size: 1.5em; cursor: pointer; }
        
        /* Rules Content */
        .rules h3 { color: var(--accent-cyan); margin: 20px 0 10px; font-family: 'Russo One', sans-serif; }
        .rules ul { padding-left: 20px; line-height: 1.8; }
        .rules p { line-height: 1.7; margin-bottom: 10px; }
        .waste-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px; margin: 15px 0; }
        .waste-item { background: rgba(0,0,0,0.3); border-radius: 8px; padding: 12px; border-left: 4px solid; }
        .waste-item h4 { font-size: 0.9em; margin-bottom: 5px; }
        .waste-item p { font-size: 0.8em; color: var(--text-secondary); }
        .principle-box { background: rgba(35,134,54,0.1); border: 1px solid rgba(35,134,54,0.3);
            border-radius: 8px; padding: 12px; margin: 10px 0; }
        .principle-box h4 { color: var(--accent-green); margin-bottom: 5px; }
        
        /* Game Over */
        .game-over { position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(13,17,23,0.95); display: none; z-index: 2000;
            flex-direction: column; align-items: center; justify-content: center; text-align: center; }
        .game-over h1 { font-family: 'Russo One', sans-serif; font-size: 3em; margin-bottom: 15px;
            background: linear-gradient(135deg, var(--accent-green), var(--accent-cyan));
            -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .final-stats { display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px; margin: 25px 0; }
        .final-stat { background: var(--bg-card); border-radius: 12px; padding: 20px; }
        .final-stat-value { font-size: 2.5em; font-weight: 700; }
        .final-stat-label { color: var(--text-secondary); margin-top: 8px; }
        
        /* Scrollbar */
        ::-webkit-scrollbar { width: 6px; height: 6px; }
        ::-webkit-scrollbar-track { background: rgba(255,255,255,0.05); }
        ::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.2); border-radius: 3px; }
        
        @media (max-width: 1200px) {
            .main { flex-direction: column; }
            .side-panel { width: 100%; max-height: 300px; }
            .kanban { min-height: 400px; }
        }
    </style>
</head>
<body>
<div class="app">
    <header class="header">
        <div class="logo">
            <span class="logo-icon">üè≠</span>
            <div>
                <div class="logo-text">Lean Flow Master</div>
                <div class="logo-sub">–ë–µ—Ä–µ–∂–ª–∏–≤–æ–µ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ + ITIL 4</div>
            </div>
        </div>
        <div class="stats">
            <div class="stat stat-score"><div class="stat-value" id="score">0</div><div class="stat-label">–û—á–∫–∏</div></div>
            <div class="stat stat-time"><div class="stat-value" id="day">–î–µ–Ω—å 1</div><div class="stat-label">–∏–∑ 20</div></div>
            <div class="stat stat-time"><div class="stat-value" id="timer">2:00</div><div class="stat-label">–û—Å—Ç–∞–ª–æ—Å—å</div></div>
            <div class="stat stat-efficiency"><div class="stat-value" id="efficiency">100%</div><div class="stat-label">–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å</div></div>
            <div class="stat stat-waste"><div class="stat-value" id="wasteCount">0</div><div class="stat-label">–ü–æ—Ç–µ—Ä—å —É—Å—Ç—Ä–∞–Ω–µ–Ω–æ</div></div>
        </div>
        <div class="controls">
            <button class="btn btn-rules" onclick="showRules()">üìñ –ü—Ä–∞–≤–∏–ª–∞</button>
            <button class="btn btn-start" onclick="startGame()" id="startBtn">‚ñ∂ –°—Ç–∞—Ä—Ç</button>
            <button class="btn btn-start" onclick="nextDay()" id="nextDayBtn" disabled style="background: var(--accent-cyan);">
                ‚û°Ô∏è –°–ª–µ–¥ –¥–µ–Ω—å
            </button>
            <button class="btn btn-reset" onclick="resetGame()">‚Üª –°–±—Ä–æ—Å</button>
        </div>
    </header>
    
    <div class="main">
        <div class="kanban" id="kanban">
            <div class="column" data-col="backlog">
                <div class="column-header">
                    <div class="column-title">üì• Backlog</div>
                    <span class="column-count" id="count-backlog">0</span>
                </div>
                <div class="column-body" id="col-backlog"></div>
            </div>
            <div class="column" data-col="analysis">
                <div class="column-header">
                    <div class="column-title">üîç –ê–Ω–∞–ª–∏–∑</div>
                    <div><span class="column-count" id="count-analysis">0</span> <span class="column-wip" id="wip-analysis">WIP: 3</span></div>
                </div>
                <div class="column-body" id="col-analysis"></div>
            </div>
            <div class="column" data-col="design">
                <div class="column-header">
                    <div class="column-title">üìê –î–∏–∑–∞–π–Ω</div>
                    <div><span class="column-count" id="count-design">0</span> <span class="column-wip" id="wip-design">WIP: 2</span></div>
                </div>
                <div class="column-body" id="col-design"></div>
            </div>
            <div class="column" data-col="develop">
                <div class="column-header">
                    <div class="column-title">üíª –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞</div>
                    <div><span class="column-count" id="count-develop">0</span> <span class="column-wip" id="wip-develop">WIP: 3</span></div>
                </div>
                <div class="column-body" id="col-develop"></div>
            </div>
            <div class="column" data-col="test">
                <div class="column-header">
                    <div class="column-title">üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ</div>
                    <div><span class="column-count" id="count-test">0</span> <span class="column-wip" id="wip-test">WIP: 2</span></div>
                </div>
                <div class="column-body" id="col-test"></div>
            </div>
            <div class="column" data-col="deploy">
                <div class="column-header">
                    <div class="column-title">üöÄ –í–Ω–µ–¥—Ä–µ–Ω–∏–µ</div>
                    <div><span class="column-count" id="count-deploy">0</span> <span class="column-wip" id="wip-deploy">WIP: 2</span></div>
                </div>
                <div class="column-body" id="col-deploy"></div>
            </div>
            <div class="column" data-col="done">
                <div class="column-header">
                    <div class="column-title">‚úÖ –ì–æ—Ç–æ–≤–æ</div>
                    <span class="column-count" id="count-done">0</span>
                </div>
                <div class="column-body" id="col-done"></div>
            </div>
        </div>
        
        <aside class="side-panel">
            <div class="panel-section">
                <div class="panel-title">üéØ –î–µ–π—Å—Ç–≤–∏—è</div>
                <button class="action-btn btn-move" onclick="moveCard()" id="btnMove" disabled>
                    <span class="icon">‚û°Ô∏è</span><span class="text">–ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å</span><span class="cost">–°–ª–µ–¥—É—é—â–∏–π —ç—Ç–∞–ø</span>
                </button>
                <button class="action-btn btn-eliminate" onclick="eliminateWaste()" id="btnEliminate" disabled>
                    <span class="icon">üóëÔ∏è</span><span class="text">–£—Å—Ç—Ä–∞–Ω–∏—Ç—å –ø–æ—Ç–µ—Ä—é</span><span class="cost">-20 –æ—á–∫–æ–≤</span>
                </button>
                <button class="action-btn btn-automate" onclick="automateProcess()" id="btnAutomate" disabled>
                    <span class="icon">ü§ñ</span><span class="text">–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å</span><span class="cost">-50 –æ—á–∫–æ–≤</span>
                </button>
                <button class="action-btn btn-kaizen" onclick="applyKaizen()" id="btnKaizen" disabled>
                    <span class="icon">üìà</span><span class="text">Kaizen —É–ª—É—á—à–µ–Ω–∏–µ</span><span class="cost">-50 –¥–æ –∫–æ–Ω—Ü–∞ –¥–Ω—è</span>
                </button>
                <button class="action-btn btn-5s" onclick="apply5S()" id="btn5S" disabled>
                    <span class="icon">üßπ</span><span class="text">5S –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è</span><span class="cost">-30 –æ—á–∫–æ–≤</span>
                </button>
                <button class="action-btn" style="background: linear-gradient(135deg, #f59e0b, #d97706);" onclick="speedUpAutomation()" id="btnSpeedUp" disabled>
                    <span class="icon">‚ö°</span><span class="text">–£—Å–∫–æ—Ä–∏—Ç—å –∞–≤—Ç–æ</span><span class="cost">-500 –æ—á–∫–æ–≤</span>
                </button>
            </div>
            
            <div class="panel-section">
                <div class="panel-title">‚ö†Ô∏è 8 –≤–∏–¥–æ–≤ –ø–æ—Ç–µ—Ä—å (MUDA)</div>
                <div class="waste-legend">
                    <div class="legend-item" onclick="highlightWaste('transport')"><span class="legend-dot" style="background:var(--waste-transport)"></span>–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞</div>
                    <div class="legend-item" onclick="highlightWaste('inventory')"><span class="legend-dot" style="background:var(--waste-inventory)"></span>–ó–∞–ø–∞—Å—ã</div>
                    <div class="legend-item" onclick="highlightWaste('motion')"><span class="legend-dot" style="background:var(--waste-motion)"></span>–õ–∏—à–Ω–∏–µ –¥–≤–∏–∂–µ–Ω–∏—è</div>
                    <div class="legend-item" onclick="highlightWaste('waiting')"><span class="legend-dot" style="background:var(--waste-waiting)"></span>–û–∂–∏–¥–∞–Ω–∏–µ</div>
                    <div class="legend-item" onclick="highlightWaste('overprod')"><span class="legend-dot" style="background:var(--waste-overprod)"></span>–ü–µ—Ä–µ–ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ</div>
                    <div class="legend-item" onclick="highlightWaste('overproc')"><span class="legend-dot" style="background:var(--waste-overproc)"></span>–ò–∑–ª–∏—à–Ω—è—è –æ–±—Ä–∞–±–æ—Ç–∫–∞</div>
                    <div class="legend-item" onclick="highlightWaste('defects')"><span class="legend-dot" style="background:var(--waste-defects)"></span>–î–µ—Ñ–µ–∫—Ç—ã</div>
                    <div class="legend-item" onclick="highlightWaste('talent')"><span class="legend-dot" style="background:var(--waste-talent)"></span>–ù–µ–∏—Å–ø. –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª</div>
                </div>
                
                <div class="itil-connection" id="itilTip">
                    <div class="itil-title">üîó –°–≤—è–∑—å —Å ITIL 4</div>
                    <div class="itil-text">–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ä—Ç–æ—á–∫—É –∏–ª–∏ –¥–µ–π—Å—Ç–≤–∏–µ, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å —Å–≤—è–∑—å —Å –ø—Ä–∞–∫—Ç–∏–∫–∞–º–∏ ITIL 4</div>
                </div>
            </div>
            
            <div class="panel-section" style="flex:1;display:flex;flex-direction:column">
                <div class="panel-title">üìú –ñ—É—Ä–Ω–∞–ª</div>
                <div class="log" id="log"></div>
            </div>
        </aside>
    </div>
</div>

<!-- Modal Rules -->
<div class="modal" id="rulesModal">
    <div class="modal-box">
        <div class="modal-header">
            <h2 class="modal-title">üìñ Lean Flow Master ‚Äî –ü—Ä–∞–≤–∏–ª–∞ –∏–≥—Ä—ã</h2>
            <button class="modal-close" onclick="closeRules()">√ó</button>
        </div>
        <div class="rules">
            <h3>üéØ –¶–µ–ª—å –∏–≥—Ä—ã</h3>
            <p>–û–ø—Ç–∏–º–∏–∑–∏—Ä—É–π—Ç–µ –ø–æ—Ç–æ–∫ —Å–æ–∑–¥–∞–Ω–∏—è —Ü–µ–Ω–Ω–æ—Å—Ç–∏ (Value Stream), —É—Å—Ç—Ä–∞–Ω—è—è 8 –≤–∏–¥–æ–≤ –ø–æ—Ç–µ—Ä—å –∏ –ø—Ä–∏–º–µ–Ω—è—è –ø—Ä–∏–Ω—Ü–∏–ø—ã –±–µ—Ä–µ–∂–ª–∏–≤–æ–≥–æ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞. –ò–∑—É—á–∏—Ç–µ —Å–≤—è–∑—å Lean —Å –ø—Ä–∞–∫—Ç–∏–∫–∞–º–∏ ITIL 4!</p>
            
            <h3>‚ö†Ô∏è 8 –≤–∏–¥–æ–≤ –ø–æ—Ç–µ—Ä—å (MUDA)</h3>
            <div class="waste-grid">
                <div class="waste-item" style="border-color:var(--waste-transport)">
                    <h4>üöö –¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞</h4>
                    <p>–õ–∏—à–Ω–∏–µ –ø–µ—Ä–µ–¥–∞—á–∏ –º–µ–∂–¥—É –∫–æ–º–∞–Ω–¥–∞–º–∏. ITIL: –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è Value Chain</p>
                </div>
                <div class="waste-item" style="border-color:var(--waste-inventory)">
                    <h4>üì¶ –ó–∞–ø–∞—Å—ã</h4>
                    <p>–ù–∞–∫–æ–ø–ª–µ–Ω–∏–µ –Ω–µ–∑–∞–≤–µ—Ä—à—ë–Ω–Ω–æ–π —Ä–∞–±–æ—Ç—ã. ITIL: WIP –ª–∏–º–∏—Ç—ã –≤ Kanban</p>
                </div>
                <div class="waste-item" style="border-color:var(--waste-motion)">
                    <h4>üèÉ –õ–∏—à–Ω–∏–µ –¥–≤–∏–∂–µ–Ω–∏—è</h4>
                    <p>–ù–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã. ITIL: Optimize & Automate</p>
                </div>
                <div class="waste-item" style="border-color:var(--waste-waiting)">
                    <h4>‚è≥ –û–∂–∏–¥–∞–Ω–∏–µ</h4>
                    <p>–ü—Ä–æ—Å—Ç–æ–∏ –∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏. ITIL: Flow management</p>
                </div>
                <div class="waste-item" style="border-color:var(--waste-overprod)">
                    <h4>üìà –ü–µ—Ä–µ–ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ</h4>
                    <p>–†–∞–±–æ—Ç–∞ –±–µ–∑ –∑–∞–ø—Ä–æ—Å–∞. ITIL: Focus on Value</p>
                </div>
                <div class="waste-item" style="border-color:var(--waste-overproc)">
                    <h4>‚öôÔ∏è –ò–∑–ª–∏—à–Ω—è—è –æ–±—Ä–∞–±–æ—Ç–∫–∞</h4>
                    <p>–ò–∑–±—ã—Ç–æ—á–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è. ITIL: Keep it Simple</p>
                </div>
                <div class="waste-item" style="border-color:var(--waste-defects)">
                    <h4>‚ùå –î–µ—Ñ–µ–∫—Ç—ã</h4>
                    <p>–û—à–∏–±–∫–∏ –∏ –ø–µ—Ä–µ–¥–µ–ª–∫–∏. ITIL: Problem Management</p>
                </div>
                <div class="waste-item" style="border-color:var(--waste-talent)">
                    <h4>üß† –ù–µ–∏—Å–ø. –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª</h4>
                    <p>–ù–∞–≤—ã–∫–∏ –∫–æ–º–∞–Ω–¥—ã –Ω–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è. ITIL: Collaborate</p>
                </div>
            </div>
            
            <h3>üéÆ –ú–µ—Ö–∞–Ω–∏–∫–∞ –∏–≥—Ä—ã</h3>
            <ul>
                <li><strong>20 –¥–Ω–µ–π</strong> ‚Äî –ø—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏–≥—Ä—ã</li>
                <li><strong>–°—Ç–∞—Ä—Ç–æ–≤—ã–π –∫–∞–ø–∏—Ç–∞–ª</strong> ‚Äî 50 –æ—á–∫–æ–≤ –¥–ª—è –Ω–∞—á–∞–ª–∞ —Ä–∞–±–æ—Ç—ã üí∞</li>
                <li><strong>2 –º–∏–Ω—É—Ç—ã –Ω–∞ –¥–µ–Ω—å</strong> ‚Äî —É –≤–∞—Å –µ—Å—Ç—å 120 —Å–µ–∫—É–Ω–¥ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–∞—Ä—Ç–æ—á–∫–∞–º–∏</li>
                <li><strong>Kanban –¥–æ—Å–∫–∞</strong> ‚Äî –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ—Ç–æ–∫–∞ —Ä–∞–±–æ—Ç</li>
                <li><strong>–ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ Backlog</strong> ‚Äî –¥–Ω–∏ 1-4: –ø–æ 10 –∑–∞–¥–∞—á, –¥–µ–Ω—å 5+: –ø–æ 20 –∑–∞–¥–∞—á –∫–∞–∂–¥—ã–π –¥–µ–Ω—å</li>
                <li><strong>WIP –ª–∏–º–∏—Ç—ã</strong> ‚Äî –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –Ω–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–¥–∞—á –≤ –∫–æ–ª–æ–Ω–∫–µ</li>
                <li>–ö–∞—Ä—Ç–æ—á–∫–∏ —Å–ª—É—á–∞–π–Ω–æ –ø–æ–ª—É—á–∞—é—Ç <strong>–ø–æ—Ç–µ—Ä–∏</strong> ‚Äî —É—Å—Ç—Ä–∞–Ω—è–π—Ç–µ –∏—Ö!</li>
                <li>–ó–∞–≤–µ—Ä—à—ë–Ω–Ω—ã–µ –∫–∞—Ä—Ç–æ—á–∫–∏ –ø—Ä–∏–Ω–æ—Å—è—Ç <strong>–æ—á–∫–∏ —Ü–µ–Ω–Ω–æ—Å—Ç–∏</strong></li>
                <li><strong>–ö–Ω–æ–ø–∫–∞ "–°–ª–µ–¥ –¥–µ–Ω—å"</strong> ‚Äî –ø–µ—Ä–µ—Ö–æ–¥ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É –¥–Ω—é (–∏–ª–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ —Ç–∞–π–º–µ—Ä—É)</li>
                <li><strong>‚ö†Ô∏è –ë–∞–ª–∞–Ω—Å 0</strong> ‚Äî –Ω–µ–ª—å–∑—è —Ä–∞—Å—Ö–æ–¥–æ–≤–∞—Ç—å –æ—á–∫–∏! –ó–∞—Ä–∞–±–æ—Ç–∞–π—Ç–µ —Å–Ω–∞—á–∞–ª–∞.</li>
            </ul>
            
            <h3>üí∞ –°–∏—Å—Ç–µ–º–∞ –æ—á–∫–æ–≤</h3>
            <ul>
                <li><strong>+–ë–∞–∑–æ–≤—ã–µ –æ—á–∫–∏</strong> ‚Äî –∑–∞ –¥–æ—Å—Ç–∞–≤–∫—É –∫–∞—Ä—Ç–æ—á–∫–∏ (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ç–∏–ø–∞ –∑–∞–¥–∞—á–∏: 15-45)</li>
                <li><strong>+10 –±–æ–Ω—É—Å</strong> ‚Äî –∑–∞ –¥–æ—Å—Ç–∞–≤–∫—É –±–µ–∑ –ø–æ—Ç–µ—Ä—å (–∫–∞—á–µ—Å—Ç–≤–æ)</li>
                <li><strong>-20 –æ—á–∫–æ–≤</strong> ‚Äî —Å—Ç–æ–∏–º–æ—Å—Ç—å —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è –ø–æ—Ç–µ—Ä–∏</li>
                <li><strong>0 —É—Å–∏–ª–∏–π</strong> ‚Äî –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ –∏–∑ Backlog –≤ —Ä–∞–±–æ—Ç—É (–Ω–∞—á–∞–ª–æ —Ä–∞–±–æ—Ç—ã –±–µ—Å–ø–ª–∞—Ç–Ω–æ) üÜì</li>
                <li><strong>-2 —É—Å–∏–ª–∏—è</strong> ‚Äî –±–∞–∑–æ–≤–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è –∑–∞–¥–∞—á–∏ –±–µ–∑ –ø–æ—Ç–µ—Ä—å ‚ö°</li>
                <li><strong>-7 —É—Å–∏–ª–∏–π</strong> ‚Äî —Å—Ç–æ–∏–º–æ—Å—Ç—å –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è –∑–∞–¥–∞—á–∏ –° –ø–æ—Ç–µ—Ä–µ–π (-2 –±–∞–∑–æ–≤—ã—Ö + -5 –∑–∞ –ø–æ—Ç–µ—Ä—é) ‚ö†Ô∏è</li>
                <li><strong>-5 –∑–∞ –ø–æ—Ç–µ—Ä—é</strong> ‚Äî —à—Ç—Ä–∞—Ñ –∑–∞ –∫–∞–∂–¥—É—é –Ω–µ—É—Å—Ç—Ä–∞–Ω—ë–Ω–Ω—É—é –ø–æ—Ç–µ—Ä—é –ø—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ –¥–Ω—è</li>
                <li><strong>-50 –æ—á–∫–æ–≤</strong> ‚Äî –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –∫–æ–ª–æ–Ω–∫–∏ (50/100/150... –∫–∞–∂–¥–∞—è —Å–ª–µ–¥—É—é—â–∞—è +50)</li>
                <li><strong>-30 –æ—á–∫–æ–≤</strong> ‚Äî –±–∞–∑–æ–≤–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å 5S –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ (+ 10 –∑–∞ –∫–∞–∂–¥—É—é –ø–æ—Ç–µ—Ä—é)</li>
                <li><strong>-50 –æ—á–∫–æ–≤</strong> ‚Äî Kaizen —É–ª—É—á—à–µ–Ω–∏–µ (+1 –∫ WIP –ª–∏–º–∏—Ç—É –¥–æ –∫–æ–Ω—Ü–∞ –¥–Ω—è)</li>
                <li><strong>-500 –æ—á–∫–æ–≤</strong> ‚Äî —É—Å–∫–æ—Ä–µ–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –¥–æ 10 —Å–µ–∫ (—É—Ä–æ–≤–µ–Ω—å 1)</li>
                <li><strong>-1500 –æ—á–∫–æ–≤</strong> ‚Äî —É—Å–∫–æ—Ä–µ–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –¥–æ 5 —Å–µ–∫ (—É—Ä–æ–≤–µ–Ω—å 2, —Ç—É—Ä–±–æ!)</li>
                <li><strong>‚ö†Ô∏è –í–ê–ñ–ù–û:</strong> –ù–µ–ª—å–∑—è —Ä–∞—Å—Ö–æ–¥–æ–≤–∞—Ç—å –æ—á–∫–∏ –ø—Ä–∏ –±–∞–ª–∞–Ω—Å–µ 0! –°–Ω–∞—á–∞–ª–∞ –∑–∞—Ä–∞–±–æ—Ç–∞–π—Ç–µ –æ—á–∫–∏.</li>
            </ul>
            
            <div class="principle-box">
                <h4>‚ö° –ü–æ—á–µ–º—É –¥–≤–∏–∂–µ–Ω–∏–µ –∑–∞–¥–∞—á —Å—Ç–æ–∏—Ç —É—Å–∏–ª–∏–π?</h4>
                <p><strong>Lean –ø—Ä–∏–Ω—Ü–∏–ø:</strong> –õ—é–±–æ–µ –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ —Ä–∞–±–æ—Ç—ã –º–µ–∂–¥—É —ç—Ç–∞–ø–∞–º–∏ —Ç—Ä–µ–±—É–µ—Ç —É—Å–∏–ª–∏–π (–∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—è, –ø–µ—Ä–µ–¥–∞—á–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞, –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ). –ü–æ—Ç–µ—Ä–∏ (MUDA) —É–≤–µ–ª–∏—á–∏–≤–∞—é—Ç —ç—Ç–∏ —É—Å–∏–ª–∏—è –≤ 3.5 —Ä–∞–∑–∞!<br>
                <strong>–ò—Å–∫–ª—é—á–µ–Ω–∏–µ:</strong> –ù–∞—á–∞–ª–æ —Ä–∞–±–æ—Ç—ã –∏–∑ Backlog –±–µ—Å–ø–ª–∞—Ç–Ω–æ ‚Äî —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ –ø—Ä–∏–Ω—è—Ç–∏–µ –∑–∞–¥–∞—á–∏ –≤ —Ä–∞–±–æ—Ç—É.<br>
                <strong>–°—Ç—Ä–∞—Ç–µ–≥–∏—è:</strong> –£—Å—Ç—Ä–∞–Ω—è–π—Ç–µ –ø–æ—Ç–µ—Ä–∏ –ü–ï–†–ï–î –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ–º –∑–∞–¥–∞—á–∏ ‚Äî —ç—Ç–æ —ç–∫–æ–Ω–æ–º–∏—Ç —É—Å–∏–ª–∏—è –∫–æ–º–∞–Ω–¥—ã –∏ –ø–æ–≤—ã—à–∞–µ—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ—Ç–æ–∫–∞.</p>
            </div>
            
            <h3>üõ† –î–µ–π—Å—Ç–≤–∏—è</h3>
            <ul>
                <li><strong>–ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å</strong> ‚Äî –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—å –∫–∞—Ä—Ç–æ—á–∫—É –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π —ç—Ç–∞–ø:
                    <ul style="margin-left: 20px; margin-top: 5px;">
                        <li>–ò–∑ Backlog: 0 —É—Å–∏–ª–∏–π (–±–µ—Å–ø–ª–∞—Ç–Ω–æ) üÜì</li>
                        <li>–ë–µ–∑ –ø–æ—Ç–µ—Ä—å: -2 —É—Å–∏–ª–∏—è ‚ö°</li>
                        <li>–° –ø–æ—Ç–µ—Ä–µ–π: -7 —É—Å–∏–ª–∏–π ‚ö†Ô∏è</li>
                    </ul>
                </li>
                <li><strong>–£—Å—Ç—Ä–∞–Ω–∏—Ç—å –ø–æ—Ç–µ—Ä—é</strong> ‚Äî —É–¥–∞–ª–∏—Ç—å waste —Å –∫–∞—Ä—Ç–æ—á–∫–∏ (-20 –æ—á–∫–æ–≤). –ë–µ–∑ –ø–æ—Ç–µ—Ä–∏ –¥–≤–∏–∂–µ–Ω–∏–µ –¥–µ—à–µ–≤–ª–µ!</li>
                <li><strong>ü§ñ –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å (50/100/150...)</strong> ‚Äî –∫–æ–ª–æ–Ω–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–º–µ—â–∞–µ—Ç –∫–∞—Ä—Ç–æ—á–∫–∏ –∫–∞–∂–¥—ã–µ 20 —Å–µ–∫—É–Ω–¥!
                    <ul style="margin-left: 20px; margin-top: 5px;">
                        <li>–ö–æ–ª–æ–Ω–∫–∞ –ø–æ–º–µ—á–∞–µ—Ç—Å—è –∑–Ω–∞—á–∫–æ–º "ü§ñ –ê–≤—Ç–æ"</li>
                        <li>–ö–∞—Ä—Ç–æ—á–∫–∏ –¥–≤–∏–≥–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ (-2 —É—Å–∏–ª–∏—è –∑–∞ –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ)</li>
                        <li>–ë–∞–∑–æ–≤–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å: –∫–∞–∂–¥—ã–µ 20 —Å–µ–∫—É–Ω–¥</li>
                        <li>–ú–æ–∂–Ω–æ —É—Å–∫–æ—Ä–∏—Ç—å –¥–æ 10 —Å–µ–∫ (-500) –∏–ª–∏ 5 —Å–µ–∫ (-1500)!</li>
                        <li>–†–∞–±–æ—Ç–∞–µ—Ç –ø–æ—Å—Ç–æ—è–Ω–Ω–æ –¥–æ –∫–æ–Ω—Ü–∞ –∏–≥—Ä—ã</li>
                        <li>–ö–∞–∂–¥–∞—è —Å–ª–µ–¥—É—é—â–∞—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –¥–æ—Ä–æ–∂–µ –Ω–∞ +50 –æ—á–∫–æ–≤</li>
                        <li>–ü–µ—Ä–≤–∞—è: 50, –≤—Ç–æ—Ä–∞—è: 100, —Ç—Ä–µ—Ç—å—è: 150 –∏ —Ç.–¥.</li>
                        <li>‚ö†Ô∏è –ö–æ–ª–æ–Ω–∫—É "–í–Ω–µ–¥—Ä–µ–Ω–∏–µ" –Ω–µ–ª—å–∑—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å!</li>
                    </ul>
                </li>
                <li><strong>üßπ 5S –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è</strong> ‚Äî —É—Å—Ç—Ä–∞–Ω–∏—Ç—å –í–°–ï –ø–æ—Ç–µ—Ä–∏ –≤ –∫–æ–ª–æ–Ω–∫–µ –æ–¥–Ω–∏–º –¥–µ–π—Å—Ç–≤–∏–µ–º!
                    <ul style="margin-left: 20px; margin-top: 5px;">
                        <li>–°—Ç–æ–∏–º–æ—Å—Ç—å: 30 (–æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è) + –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–ø–æ—Ç–µ—Ä—å √ó 10 (—É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ)</li>
                        <li>–ü—Ä–∏–º–µ—Ä: 3 –ø–æ—Ç–µ—Ä–∏ = -30 -30 = -60 –æ—á–∫–æ–≤</li>
                        <li>–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞: —É—Å—Ç—Ä–∞–Ω–∏—Ç—å –ø–æ –æ–¥–Ω–æ–π = 3√ó20 = -60 –æ—á–∫–æ–≤ (—Ç–∞ –∂–µ —Ü–µ–Ω–∞!)</li>
                        <li>5S —É–¥–æ–±–Ω–µ–µ ‚Äî –æ–¥–Ω–∏–º –¥–µ–π—Å—Ç–≤–∏–µ–º –≤–º–µ—Å—Ç–æ —Ç—Ä—ë—Ö. –≠–∫–æ–Ω–æ–º–∏—è –≤—Ä–µ–º–µ–Ω–∏!</li>
                    </ul>
                </li>
                <li><strong>üìà Kaizen —É–ª—É—á—à–µ–Ω–∏–µ (-50 –æ—á–∫–æ–≤)</strong> ‚Äî –≤—Ä–µ–º–µ–Ω–Ω–æ —É–≤–µ–ª–∏—á–∏—Ç—å WIP –ª–∏–º–∏—Ç –∫–æ–ª–æ–Ω–∫–∏ –Ω–∞ +1 –¥–æ –∫–æ–Ω—Ü–∞ —Ç–µ–∫—É—â–µ–≥–æ –¥–Ω—è
                    <ul style="margin-left: 20px; margin-top: 5px;">
                        <li>–≠—Ñ—Ñ–µ–∫—Ç –¥–µ–π—Å—Ç–≤—É–µ—Ç —Ç–æ–ª—å–∫–æ –¥–æ –∫–æ–Ω—Ü–∞ —Ç–µ–∫—É—â–µ–≥–æ –¥–Ω—è</li>
                        <li>–ü—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π –¥–µ–Ω—å WIP –ª–∏–º–∏—Ç –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –∫ –±–∞–∑–æ–≤–æ–º—É –∑–Ω–∞—á–µ–Ω–∏—é</li>
                        <li>–ú–æ–∂–Ω–æ –ø—Ä–∏–º–µ–Ω—è—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ –Ω–∞ –æ–¥–Ω—É –∫–æ–ª–æ–Ω–∫—É –∑–∞ –¥–µ–Ω—å</li>
                        <li>–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è —É–∑–∫–∏—Ö –º–µ—Å—Ç –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ</li>
                    </ul>
                </li>
                <li><strong>‚ö° –£—Å–∫–æ—Ä–µ–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏</strong> ‚Äî —É–≤–µ–ª–∏—á–∏—Ç—å —Å–∫–æ—Ä–æ—Å—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–π:
                    <ul style="margin-left: 20px; margin-top: 5px;">
                        <li>–£—Ä–æ–≤–µ–Ω—å 1: -500 –æ—á–∫–æ–≤ ‚Üí —Å–∫–æ—Ä–æ—Å—Ç—å 10 —Å–µ–∫ (–≤–º–µ—Å—Ç–æ 20 —Å–µ–∫)</li>
                        <li>–£—Ä–æ–≤–µ–Ω—å 2: -1500 –æ—á–∫–æ–≤ ‚Üí —Å–∫–æ—Ä–æ—Å—Ç—å 5 —Å–µ–∫ (—Ç—É—Ä–±–æ —Ä–µ–∂–∏–º!)</li>
                        <li>–†–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è –≤—Å–µ—Ö –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∫–æ–ª–æ–Ω–æ–∫ —Å—Ä–∞–∑—É</li>
                        <li>–¢—Ä–µ–±—É–µ—Ç –Ω–∞–ª–∏—á–∏–µ —Ö–æ—Ç—è –±—ã –æ–¥–Ω–æ–π –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –∫–æ–ª–æ–Ω–∫–∏</li>
                    </ul>
                </li>
            </ul>
            
            <div class="principle-box">
                <h4>üîó –°–≤—è–∑—å —Å ITIL 4</h4>
                <p>Lean –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω –≤ ITIL 4 —á–µ—Ä–µ–∑ –ø—Ä–∏–Ω—Ü–∏–ø—ã:<br>
                ‚Ä¢ <strong>Focus on Value</strong> ‚Äî —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø–æ—Ç–µ—Ä—å<br>
                ‚Ä¢ <strong>Optimize and Automate</strong> ‚Äî –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è<br>
                ‚Ä¢ <strong>Collaborate</strong> ‚Äî –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª–∞ –∫–æ–º–∞–Ω–¥—ã<br>
                ‚Ä¢ <strong>Keep it Simple</strong> ‚Äî —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –∏–∑–ª–∏—à–Ω–µ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏<br>
                ‚Ä¢ <strong>Progress Iteratively</strong> ‚Äî Kaizen —É–ª—É—á—à–µ–Ω–∏—è</p>
            </div>
        </div>
    </div>
</div>

<!-- Game Over -->
<div class="game-over" id="gameOver">
    <h1>üèÜ –°–∏–º—É–ª—è—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞!</h1>
    <p style="font-size:1.2em;color:var(--text-secondary);margin-bottom:20px">–í—ã –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–ª–∏ –ø–æ—Ç–æ–∫ —Å–æ–∑–¥–∞–Ω–∏—è —Ü–µ–Ω–Ω–æ—Å—Ç–∏!</p>
    <div class="final-stats">
        <div class="final-stat"><div class="final-stat-value" style="color:var(--accent-green)" id="fDelivered">0</div><div class="final-stat-label">–î–æ—Å—Ç–∞–≤–ª–µ–Ω–æ</div></div>
        <div class="final-stat"><div class="final-stat-value" style="color:var(--accent-red)" id="fWaste">0</div><div class="final-stat-label">–ü–æ—Ç–µ—Ä—å —É—Å—Ç—Ä–∞–Ω–µ–Ω–æ</div></div>
        <div class="final-stat"><div class="final-stat-value" style="color:var(--accent-cyan)" id="fEfficiency">0%</div><div class="final-stat-label">–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å</div></div>
        <div class="final-stat"><div class="final-stat-value" style="color:var(--accent-orange)" id="fScore">0</div><div class="final-stat-label">–ò—Ç–æ–≥–æ–≤—ã–π —Å—á—ë—Ç</div></div>
    </div>
    <button class="btn btn-start" style="padding:15px 50px;font-size:1.1em" onclick="resetGame();document.getElementById('gameOver').style.display='none'">üîÑ –ò–≥—Ä–∞—Ç—å —Å–Ω–æ–≤–∞</button>
</div>

<script>
// –î–∞–Ω–Ω—ã–µ
const COLUMNS = ['backlog','analysis','design','develop','test','deploy','done'];
const WIP_LIMITS = {analysis:3, design:2, develop:3, test:2, deploy:2};
const CARD_TEMPLATES = [
    {title:'–ù–æ–≤—ã–π –º–æ–¥—É–ª—å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏', type:'feature', value:30},
    {title:'–ò—Å–ø—Ä–∞–≤–∏—Ç—å –ø–∞–¥–µ–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–∞', type:'bug', value:20},
    {title:'–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö', type:'improvement', value:25},
    {title:'–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å CRM', type:'feature', value:35},
    {title:'–ú–∏–≥—Ä–∞—Ü–∏—è –Ω–∞ –Ω–æ–≤—ã–π —Å–µ—Ä–≤–µ—Ä', type:'improvement', value:40},
    {title:'–ó–∞–ø—Ä–æ—Å –Ω–∞ –æ—Ç—á—ë—Ç–Ω–æ—Å—Ç—å', type:'request', value:15},
    {title:'–ú–æ–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ', type:'feature', value:45},
    {title:'–û—à–∏–±–∫–∞ –≤ —Ä–∞—Å—á—ë—Ç–∞—Ö', type:'bug', value:20},
    {title:'–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –¥–µ–ø–ª–æ—è', type:'improvement', value:30},
    {title:'–ü–æ—Ä—Ç–∞–ª —Å–∞–º–æ–æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è', type:'request', value:25}
];
const WASTE_TYPES = [
    {id:'transport', name:'–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞', icon:'üöö', itil:'–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è Value Chain ‚Äî –º–∏–Ω–∏–º–∏–∑–∞—Ü–∏—è –ø–µ—Ä–µ–¥–∞—á –º–µ–∂–¥—É –∫–æ–º–∞–Ω–¥–∞–º–∏'},
    {id:'inventory', name:'–ó–∞–ø–∞—Å—ã', icon:'üì¶', itil:'WIP –ª–∏–º–∏—Ç—ã –≤ –ø—Ä–∞–∫—Ç–∏–∫–µ Kanban ‚Äî –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –Ω–µ–∑–∞–≤–µ—Ä—à—ë–Ω–Ω–æ–π —Ä–∞–±–æ—Ç—ã'},
    {id:'motion', name:'–õ–∏—à–Ω–∏–µ –¥–≤–∏–∂–µ–Ω–∏—è', icon:'üèÉ', itil:'–ü—Ä–∏–Ω—Ü–∏–ø Optimize & Automate ‚Äî —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ª–∏—à–Ω–∏—Ö –¥–µ–π—Å—Ç–≤–∏–π'},
    {id:'waiting', name:'–û–∂–∏–¥–∞–Ω–∏–µ', icon:'‚è≥', itil:'Flow Management ‚Äî —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫ –∏ –ø—Ä–æ—Å—Ç–æ–µ–≤'},
    {id:'overprod', name:'–ü–µ—Ä–µ–ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ', icon:'üìà', itil:'–ü—Ä–∏–Ω—Ü–∏–ø Focus on Value ‚Äî –¥–µ–ª–∞—Ç—å —Ç–æ–ª—å–∫–æ —Ç–æ, —á—Ç–æ –Ω—É–∂–Ω–æ'},
    {id:'overproc', name:'–ò–∑–ª–∏—à–Ω—è—è –æ–±—Ä–∞–±–æ—Ç–∫–∞', icon:'‚öôÔ∏è', itil:'–ü—Ä–∏–Ω—Ü–∏–ø Keep it Simple ‚Äî –Ω–µ —É—Å–ª–æ–∂–Ω—è—Ç—å –±–µ–∑ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏'},
    {id:'defects', name:'–î–µ—Ñ–µ–∫—Ç—ã', icon:'‚ùå', itil:'Problem Management ‚Äî —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –∫–æ—Ä–Ω–µ–≤—ã—Ö –ø—Ä–∏—á–∏–Ω'},
    {id:'talent', name:'–ù–µ–∏—Å–ø. –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª', icon:'üß†', itil:'–ü—Ä–∏–Ω—Ü–∏–ø Collaborate ‚Äî –≤–æ–≤–ª–µ—á–µ–Ω–∏–µ –∏ —Ä–∞–∑–≤–∏—Ç–∏–µ –∫–æ–º–∞–Ω–¥—ã'}
];

// –°–æ—Å—Ç–æ—è–Ω–∏–µ
let G = {
    day: 0, maxDays: 20, score: 0, wasteEliminated: 0, delivered: 0,
    cards: [], cardCounter: 0, selected: null, running: false,
    wipLimits: {...WIP_LIMITS}, 
    baseWipLimits: {...WIP_LIMITS}, // –ë–∞–∑–æ–≤—ã–µ WIP –ª–∏–º–∏—Ç—ã –¥–ª—è —Å–±—Ä–æ—Å–∞ Kaizen
    automated: {},
    automationCount: 0, // –°—á–µ—Ç—á–∏–∫ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–π
    automationSpeed: 20, // –°–∫–æ—Ä–æ—Å—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –≤ —Å–µ–∫—É–Ω–¥–∞—Ö (20 -> 10 -> 5)
    dayTimeLeft: 120, // 2 –º–∏–Ω—É—Ç—ã –≤ —Å–µ–∫—É–Ω–¥–∞—Ö
    timerInterval: null
};

// –£—Ç–∏–ª–∏—Ç—ã
function rnd(arr) { return arr[Math.floor(Math.random()*arr.length)]; }
function rndInt(min,max) { return Math.floor(Math.random()*(max-min+1))+min; }

function log(msg, type='info') {
    const el = document.getElementById('log');
    const e = document.createElement('div');
    e.className = `log-entry ${type}`;
    e.textContent = `–î–µ–Ω—å ${G.day}: ${msg}`;
    el.insertBefore(e, el.firstChild);
    while(el.children.length > 30) el.removeChild(el.lastChild);
}

function updateStats() {
    const total = G.cards.filter(c=>c.column!=='done').length;
    const withWaste = G.cards.filter(c=>c.waste && c.column!=='done').length;
    const eff = total > 0 ? Math.round((1 - withWaste/Math.max(total,1))*100) : 100;
    
    document.getElementById('efficiency').textContent = eff + '%';
    document.getElementById('wasteCount').textContent = G.wasteEliminated;
    
    const scoreEl = document.getElementById('score');
    scoreEl.textContent = G.score;
    // Color score based on balance
    if (G.score <= 0) {
        scoreEl.style.color = 'var(--accent-red)';
    } else if (G.score < 10) {
        scoreEl.style.color = 'var(--accent-orange)';
    } else {
        scoreEl.style.color = 'var(--accent-cyan)';
    }
    
    document.getElementById('day').textContent = `–î–µ–Ω—å ${G.day}`;
    
    // Update timer
    const minutes = Math.floor(G.dayTimeLeft / 60);
    const seconds = G.dayTimeLeft % 60;
    const timerEl = document.getElementById('timer');
    timerEl.textContent = `${minutes}:${seconds.toString().padStart(2, '0')}`;
    
    // Color timer based on time left
    if (G.dayTimeLeft <= 30) {
        timerEl.style.color = 'var(--accent-red)';
    } else if (G.dayTimeLeft <= 60) {
        timerEl.style.color = 'var(--accent-orange)';
    } else {
        timerEl.style.color = 'var(--text-primary)';
    }
    
    // Update column counts
    COLUMNS.forEach(col => {
        const count = G.cards.filter(c=>c.column===col).length;
        document.getElementById(`count-${col}`).textContent = count;
        if(G.wipLimits[col]) {
            const wipEl = document.getElementById(`wip-${col}`);
            const hasKaizen = G.wipLimits[col] > G.baseWipLimits[col];
            wipEl.textContent = `WIP: ${G.wipLimits[col]}${hasKaizen ? ' üìà' : ''}`;
            
            if (count > G.wipLimits[col]) {
                wipEl.className = 'column-wip exceeded';
            } else if (hasKaizen) {
                wipEl.className = 'column-wip kaizen';
            } else {
                wipEl.className = 'column-wip';
            }
        }
    });
}

function updateButtons() {
    const s = G.selected;
    const hasWaste = s && s.waste;
    
    // Calculate move cost
    let moveCost = 0;
    if (s && s.column !== 'backlog') {
        moveCost = 2; // –ë–∞–∑–æ–≤–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è
        if (hasWaste) {
            moveCost += 5; // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É—Å–∏–ª–∏—è –∏–∑-–∑–∞ –ø–æ—Ç–µ—Ä–∏
        }
    }
    // –ò–∑ backlog –≤ analysis - –±–µ—Å–ø–ª–∞—Ç–Ω–æ (–Ω–∞—á–∞–ª–æ —Ä–∞–±–æ—Ç—ã)
    
    // Can move if: selected, not done, and (from backlog OR have enough score)
    const canMove = s && s.column !== 'done' && (s.column === 'backlog' || G.score >= moveCost);
    
    const btnMove = document.getElementById('btnMove');
    btnMove.disabled = !canMove;
    if (s && s.column !== 'done') {
        let costText = '';
        if (s.column === 'backlog') {
            costText = `<span class="cost" style="color: var(--accent-green)">–ù–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç—É</span>`;
        } else if (G.score < moveCost) {
            costText = `<span class="cost" style="color: var(--accent-red)">–ù—É–∂–Ω–æ ${moveCost} –æ—á–∫–æ–≤! ‚ùå</span>`;
        } else {
            costText = hasWaste 
                ? `<span class="cost" style="color: var(--accent-red)">-${moveCost} —É—Å–∏–ª–∏–π ‚ö†Ô∏è</span>` 
                : `<span class="cost">-${moveCost} —É—Å–∏–ª–∏–π</span>`;
        }
        btnMove.innerHTML = `<span class="icon">‚û°Ô∏è</span><span class="text">–ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å</span>${costText}`;
    }
    
    document.getElementById('btnEliminate').disabled = !hasWaste || G.score < 20;
    
    // Automate button
    const btnAutomate = document.getElementById('btnAutomate');
    const isAutomated = s && G.automated[s.column];
    const isDeployColumn = s && s.column === 'deploy';
    const automationCost = 50 + (G.automationCount * 50); // 50, 100, 150, 200...
    
    btnAutomate.disabled = !s || G.score < automationCost || isAutomated || isDeployColumn;
    
    if (isDeployColumn) {
        btnAutomate.innerHTML = `<span class="icon">üö´</span><span class="text">–í–Ω–µ–¥—Ä–µ–Ω–∏–µ</span><span class="cost">–ù–µ–ª—å–∑—è –∞–≤—Ç–æ</span>`;
    } else if (isAutomated) {
        btnAutomate.innerHTML = `<span class="icon">‚úÖ</span><span class="text">–£–∂–µ –∞–≤—Ç–æ</span><span class="cost">–ê–∫—Ç–∏–≤–Ω–æ</span>`;
    } else {
        btnAutomate.innerHTML = `<span class="icon">ü§ñ</span><span class="text">–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å</span><span class="cost">-${automationCost} –æ—á–∫–æ–≤</span>`;
    }
    
    // 5S button
    const wastesInColumn = s ? G.cards.filter(c=>c.column===s.column && c.waste).length : 0;
    const cost5S = 30 + (wastesInColumn * 10);
    const btn5S = document.getElementById('btn5S');
    btn5S.disabled = !s || G.score < cost5S;
    if (s) {
        btn5S.innerHTML = `<span class="icon">üßπ</span><span class="text">5S –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è</span><span class="cost">-${cost5S} (${wastesInColumn} –ø–æ—Ç–µ—Ä—å)</span>`;
    }
    
    const btnKaizen = document.getElementById('btnKaizen');
    const kaizenCost = 50;
    btnKaizen.disabled = !s || G.score < kaizenCost || !G.wipLimits[s?.column];
    if (s && G.wipLimits[s.column]) {
        const canAfford = G.score >= kaizenCost;
        btnKaizen.innerHTML = `<span class="icon">üìà</span><span class="text">Kaizen —É–ª—É—á—à–µ–Ω–∏–µ</span><span class="cost" style="color: ${canAfford ? 'inherit' : 'var(--accent-red)'}">-${kaizenCost} –¥–æ –∫–æ–Ω—Ü–∞ –¥–Ω—è</span>`;
    }
    
    // Speed up button
    const btnSpeedUp = document.getElementById('btnSpeedUp');
    const hasAutomation = Object.keys(G.automated).length > 0;
    
    if (G.automationSpeed === 20) {
        const speedCost = 500;
        btnSpeedUp.disabled = !hasAutomation || G.score < speedCost;
        btnSpeedUp.innerHTML = `<span class="icon">‚ö°</span><span class="text">–£—Å–∫–æ—Ä–∏—Ç—å –∞–≤—Ç–æ</span><span class="cost">${hasAutomation ? `-${speedCost} ‚Üí 10 —Å–µ–∫` : '–ù—É–∂–Ω–∞ –∞–≤—Ç–æ'}</span>`;
    } else if (G.automationSpeed === 10) {
        const speedCost = 1500;
        btnSpeedUp.disabled = !hasAutomation || G.score < speedCost;
        btnSpeedUp.innerHTML = `<span class="icon">‚ö°‚ö°</span><span class="text">–¢—É—Ä–±–æ –∞–≤—Ç–æ</span><span class="cost">${hasAutomation ? `-${speedCost} ‚Üí 5 —Å–µ–∫` : '–ù—É–∂–Ω–∞ –∞–≤—Ç–æ'}</span>`;
    } else {
        btnSpeedUp.disabled = true;
        btnSpeedUp.innerHTML = `<span class="icon">‚úÖ</span><span class="text">–ú–∞–∫—Å —Å–∫–æ—Ä–æ—Å—Ç—å</span><span class="cost">5 —Å–µ–∫</span>`;
    }
}

function showItilTip(text) {
    document.getElementById('itilTip').innerHTML = `<div class="itil-title">üîó –°–≤—è–∑—å —Å ITIL 4</div><div class="itil-text">${text}</div>`;
}

function showScoreAnimation(text) {
    const scoreEl = document.getElementById('score');
    const rect = scoreEl.getBoundingClientRect();
    
    const popup = document.createElement('div');
    popup.style.position = 'fixed';
    popup.style.left = rect.left + 'px';
    popup.style.top = rect.top + 'px';
    popup.style.fontSize = '2em';
    popup.style.fontWeight = 'bold';
    popup.style.color = text.startsWith('+') ? 'var(--accent-green)' : 'var(--accent-red)';
    popup.style.zIndex = '3000';
    popup.style.pointerEvents = 'none';
    popup.style.animation = 'floatUp 1s ease-out';
    popup.textContent = text;
    
    document.body.appendChild(popup);
    
    setTimeout(() => popup.remove(), 1000);
}

// Add animation CSS
const style = document.createElement('style');
style.textContent = `
    @keyframes floatUp {
        0% { opacity: 0; transform: translateY(0); }
        50% { opacity: 1; transform: translateY(-30px); }
        100% { opacity: 0; transform: translateY(-60px); }
    }
`;
document.head.appendChild(style);

// Cards
function createCard() {
    G.cardCounter++;
    const tpl = rnd(CARD_TEMPLATES);
    const card = {
        id: G.cardCounter,
        title: tpl.title,
        type: tpl.type,
        value: tpl.value,
        column: 'backlog',
        waste: Math.random() < 0.4 ? rnd(WASTE_TYPES) : null,
        daysInColumn: 0
    };
    G.cards.push(card);
    return card;
}

function updateColumnVisuals() {
    // Update automated columns visual indication
    COLUMNS.forEach(col => {
        const columnEl = document.querySelector(`[data-col="${col}"]`);
        if (columnEl) {
            if (G.automated[col]) {
                columnEl.classList.add('automated');
            } else {
                columnEl.classList.remove('automated');
            }
        }
    });
}

function renderCards() {
    COLUMNS.forEach(col => {
        const container = document.getElementById(`col-${col}`);
        container.innerHTML = '';
        G.cards.filter(c=>c.column===col).forEach(card => {
            const el = document.createElement('div');
            el.className = `card ${card.waste ? 'has-waste' : ''} ${G.selected?.id===card.id ? 'selected' : ''}`;
            el.onclick = () => selectCard(card);
            
            let wasteHtml = '';
            if(card.waste) {
                wasteHtml = `<span class="card-waste-indicator">${card.waste.icon}</span>
                    <div class="waste-badge waste-${card.waste.id}">${card.waste.icon} ${card.waste.name}</div>`;
            }
            
            // Calculate move cost for display
            let moveCostHtml = '';
            if (card.column !== 'done' && card.column !== 'backlog') {
                let moveCost = 2;
                if (card.waste) moveCost += 5;
                const moveCostColor = card.waste ? 'var(--accent-red)' : 'var(--text-secondary)';
                moveCostHtml = `<span class="card-effort" style="color: ${moveCostColor}">‚ö° ${moveCost}</span>`;
            } else if (card.column === 'backlog') {
                // –í backlog –ø–æ–∫–∞–∑—ã–≤–∞–µ–º, —á—Ç–æ –Ω–∞—á–∞–ª–æ —Ä–∞–±–æ—Ç—ã –±–µ—Å–ø–ª–∞—Ç–Ω–æ
                moveCostHtml = `<span class="card-effort" style="color: var(--accent-green)">‚ö° 0</span>`;
            }
            
            el.innerHTML = `
                <div class="card-id">TASK-${String(card.id).padStart(3,'0')}</div>
                <div class="card-title">${card.title}</div>
                <span class="card-type type-${card.type}">${card.type}</span>
                ${wasteHtml}
                <div class="card-footer">
                    <span class="card-value">üíé ${card.value}</span>
                    ${moveCostHtml}
                    <span class="card-time">üìÖ ${card.daysInColumn}–¥</span>
                </div>
            `;
            container.appendChild(el);
        });
    });
}

function selectCard(card) {
    G.selected = G.selected?.id === card.id ? null : card;
    renderCards();
    updateButtons();
    
    if(G.selected) {
        const col = G.selected.column;
        const isAutomated = G.automated[col];
        const wastesInColumn = G.cards.filter(c=>c.column===col && c.waste).length;
        
        let tip = '';
        
        if (G.selected.column === 'backlog') {
            if (G.selected.waste) {
                tip = `üì• <strong>–ó–∞–¥–∞—á–∞ –≤ Backlog —Å –ø–æ—Ç–µ—Ä–µ–π</strong><br>–ù–∞—á–∞–ª–æ —Ä–∞–±–æ—Ç—ã –±–µ—Å–ø–ª–∞—Ç–Ω–æ (0 —É—Å–∏–ª–∏–π), –Ω–æ –ø–æ—Ç–µ—Ä—è –±—É–¥–µ—Ç –º–µ—à–∞—Ç—å –Ω–∞ —Å–ª–µ–¥—É—é—â–∏—Ö —ç—Ç–∞–ø–∞—Ö.<br><br>üí° <strong>–°–æ–≤–µ—Ç:</strong> –ú–æ–∂–Ω–æ –Ω–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç—É —Å–µ–π—á–∞—Å –∏ —É—Å—Ç—Ä–∞–Ω–∏—Ç—å –ø–æ—Ç–µ—Ä—é –ø–æ–∑–∂–µ (-20 –æ—á–∫–æ–≤), –∏–ª–∏ –¥–≤–∏–≥–∞—Ç—å —Å –ø–æ—Ç–µ—Ä–µ–π –∑–∞ -7 —É—Å–∏–ª–∏–π.`;
            } else {
                tip = `üì• <strong>–ó–∞–¥–∞—á–∞ –≤ Backlog –≥–æ—Ç–æ–≤–∞ –∫ —Ä–∞–±–æ—Ç–µ</strong><br>–ù–∞—á–∞–ª–æ —Ä–∞–±–æ—Ç—ã: 0 —É—Å–∏–ª–∏–π (–±–µ—Å–ø–ª–∞—Ç–Ω–æ).<br><br>–ù–∞–∂–º–∏—Ç–µ "–ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å" —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç—É –Ω–∞–¥ –∑–∞–¥–∞—á–µ–π.`;
            }
        } else if(G.selected.waste) {
            const moveCost = 7;
            if (G.score < moveCost) {
                tip = `‚ùå <strong>–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –æ—á–∫–æ–≤!</strong><br>–î–ª—è –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è –Ω—É–∂–Ω–æ ${moveCost} –æ—á–∫–æ–≤, –∞ —É –≤–∞—Å: ${G.score}.<br><br>‚ö†Ô∏è –ü–æ—Ç–µ—Ä—è —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç —Å—Ç–æ–∏–º–æ—Å—Ç—å –≤ 3.5 —Ä–∞–∑–∞!<br><br>üí° <strong>–°–æ–≤–µ—Ç:</strong> –î–æ—Å—Ç–∞–≤—å—Ç–µ –≥–æ—Ç–æ–≤—ã–µ –∑–∞–¥–∞—á–∏ –∏–ª–∏ —É—Å—Ç—Ä–∞–Ω–∏—Ç–µ –ø–æ—Ç–µ—Ä–∏ –≤ –¥—Ä—É–≥–∏—Ö –∑–∞–¥–∞—á–∞—Ö, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –æ—á–∫–∏.`;
            } else {
                tip = `‚ö†Ô∏è <strong>–ü–æ—Ç–µ—Ä—è —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç —É—Å–∏–ª–∏—è!</strong><br>–ü–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ –±—É–¥–µ—Ç —Å—Ç–æ–∏—Ç—å -${moveCost} —É—Å–∏–ª–∏–π –≤–º–µ—Å—Ç–æ -2.<br><br>${G.selected.waste.itil}<br><br>üí° <strong>–°–æ–≤–µ—Ç:</strong> –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø–æ—Ç–µ—Ä–∏ (-20), –∑–∞—Ç–µ–º –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ (-2) = -22 –æ—á–∫–æ–≤ –ø—Ä–æ—Ç–∏–≤ -7 –∑–∞ –¥–≤–∏–∂–µ–Ω–∏–µ —Å –ø–æ—Ç–µ—Ä–µ–π. –≠–∫–æ–Ω–æ–º–∏—è: 15 –æ—á–∫–æ–≤ –Ω–∞ –¥–æ–ª–≥–æ–π –¥–∏—Å—Ç–∞–Ω—Ü–∏–∏!`;
            }
        } else {
            const moveCost = 2;
            if (G.score < moveCost) {
                tip = `‚ùå <strong>–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –æ—á–∫–æ–≤!</strong><br>–î–ª—è –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è –Ω—É–∂–Ω–æ ${moveCost} –æ—á–∫–∞, –∞ —É –≤–∞—Å: ${G.score}.<br><br>üí° <strong>–°–æ–≤–µ—Ç:</strong> –î–æ—Å—Ç–∞–≤—å—Ç–µ –≥–æ—Ç–æ–≤—ã–µ –∑–∞–¥–∞—á–∏ –∏–ª–∏ —É—Å—Ç—Ä–∞–Ω–∏—Ç–µ –ø–æ—Ç–µ—Ä–∏ (+20), —á—Ç–æ–±—ã –∑–∞—Ä–∞–±–æ—Ç–∞—Ç—å –æ—á–∫–∏.`;
            } else {
                tip = '‚úÖ <strong>–ó–∞–¥–∞—á–∞ –±–µ–∑ –ø–æ—Ç–µ—Ä—å</strong> ‚Äî –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ —Å—Ç–æ–∏—Ç –≤—Å–µ–≥–æ -2 —É—Å–∏–ª–∏—è.<br><br>–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ –¥–ª—è –∫–∞—Ä—Ç–æ—á–∫–∏. –ö–∞–∂–¥–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ —Å–≤—è–∑–∞–Ω–æ —Å –ø—Ä–∞–∫—Ç–∏–∫–æ–π ITIL 4.';
            }
        }
        
        // Add automation info
        if (isAutomated) {
            tip += '<br><br>ü§ñ <strong>–ö–æ–ª–æ–Ω–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–∞!</strong> –ó–∞–¥–∞—á–∏ –ø–µ—Ä–µ–º–µ—â–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∫–∞–∂–¥—ã–µ 20 —Å–µ–∫ (-2 —É—Å–∏–ª–∏—è).';
        } else if (col === 'deploy') {
            tip += '<br><br>üö´ <strong>–í–Ω–µ–¥—Ä–µ–Ω–∏–µ –Ω–µ–ª—å–∑—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å!</strong> –≠—Ç–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π —ç—Ç–∞–ø, —Ç—Ä–µ–±—É—é—â–∏–π —Ä—É—á–Ω–æ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª—è.';
        } else if (col !== 'backlog' && col !== 'done') {
            const automationCost = 50 + (G.automationCount * 50);
            tip += `<br><br>ü§ñ <strong>–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è (-${automationCost}):</strong> –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ –∫–∞—Ä—Ç–æ—á–µ–∫ –∫–∞–∂–¥—ã–µ 20 —Å–µ–∫ (-2 —É—Å–∏–ª–∏—è –∑–∞ –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ). –°–ª–µ–¥—É—é—â–∞—è –±—É–¥–µ—Ç —Å—Ç–æ–∏—Ç—å +50 –æ—á–∫–æ–≤.`;
        }
        
        // Add 5S info
        if (wastesInColumn > 0 && col !== 'backlog' && col !== 'done') {
            tip += `<br><br>üßπ <strong>5S –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è (-${30 + wastesInColumn * 10}):</strong> –£—Å—Ç—Ä–∞–Ω–∏—Ç –í–°–ï ${wastesInColumn} –ø–æ—Ç–µ—Ä—å –≤ –∫–æ–ª–æ–Ω–∫–µ (30 –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è + ${wastesInColumn}√ó10 —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ).`;
        }
        
        showItilTip(tip);
    }
}

// Actions
function moveCard() {
    if(!G.selected || G.selected.column === 'done') return;
    
    const currentCol = G.selected.column;
    const idx = COLUMNS.indexOf(currentCol);
    const nextCol = COLUMNS[idx + 1];
    
    // Check WIP
    if(G.wipLimits[nextCol]) {
        const count = G.cards.filter(c=>c.column===nextCol).length;
        if(count >= G.wipLimits[nextCol]) {
            log(`WIP –ª–∏–º–∏—Ç –ø—Ä–µ–≤—ã—à–µ–Ω –≤ "${nextCol}"! –°–Ω–∞—á–∞–ª–∞ –æ—Å–≤–æ–±–æ–¥–∏—Ç–µ –∫–æ–ª–æ–Ω–∫—É.`, 'warning');
            return;
        }
    }
    
    // Calculate move cost (effort)
    let moveCost = 0;
    if (currentCol !== 'backlog') {
        moveCost = 2; // –ë–∞–∑–æ–≤–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å
        if (G.selected.waste) {
            moveCost += 5; // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É—Å–∏–ª–∏—è –∏–∑-–∑–∞ –ø–æ—Ç–µ—Ä–∏
        }
        
        // Check if we have enough score to move
        if (G.score < moveCost) {
            log(`‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –æ—á–∫–æ–≤ –¥–ª—è –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è! –ù—É–∂–Ω–æ: ${moveCost}, –µ—Å—Ç—å: ${G.score}`, 'warning');
            showScoreAnimation('‚ùå');
            return;
        }
    }
    // –ò–∑ backlog - –±–µ—Å–ø–ª–∞—Ç–Ω–æ
    
    const wasteWarning = G.selected.waste ? ' ‚ö†Ô∏è –° –ø–æ—Ç–µ—Ä–µ–π!' : '';
    
    G.selected.column = nextCol;
    G.selected.daysInColumn = 0;
    
    if(nextCol === 'done') {
        let points = G.selected.value;
        let bonusText = '';
        
        // –ë–æ–Ω—É—Å –∑–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø–æ—Ç–µ—Ä—å
        if (!G.selected.waste) {
            points += 10;
            bonusText = ' +10 –±–æ–Ω—É—Å –∑–∞ –∫–∞—á–µ—Å—Ç–≤–æ';
        }
        
        // Net gain = value + bonus - move cost
        const netGain = points - moveCost;
        G.score += netGain;
        G.delivered++;
        G.selected.dayDelivered = G.day;
        
        showScoreAnimation(netGain >= 0 ? `+${netGain}` : `${netGain}`);
        log(`‚úÖ –î–æ—Å—Ç–∞–≤–ª–µ–Ω–æ: ${G.selected.title} (+${points}${bonusText} -${moveCost} —É—Å–∏–ª–∏–π = ${netGain >= 0 ? '+' : ''}${netGain}) | –í—Å–µ–≥–æ: ${G.score}`, 'success');
        showItilTip('–ü—Ä–∞–∫—Ç–∏–∫–∞ Deployment Management ‚Äî –¥–æ—Å—Ç–∞–≤–∫–∞ —Ü–µ–Ω–Ω–æ—Å—Ç–∏ –∫–ª–∏–µ–Ω—Ç—É. –ü—Ä–∏–Ω—Ü–∏–ø Progress Iteratively ‚Äî –∏—Ç–µ—Ä–∞—Ç–∏–≤–Ω–æ–µ —É–ª—É—á—à–µ–Ω–∏–µ.');
    } else {
        if (moveCost > 0) {
            // Deduct effort cost for non-backlog moves
            G.score = Math.max(0, G.score - moveCost);
            showScoreAnimation(`-${moveCost}`);
            log(`‚û°Ô∏è ${G.selected.title} ‚Üí "${nextCol}" (-${moveCost} —É—Å–∏–ª–∏–π${wasteWarning}) | –í—Å–µ–≥–æ: ${G.score}`, 'info');
        } else {
            // Free move from backlog
            log(`‚û°Ô∏è ${G.selected.title} ‚Üí "${nextCol}" (–Ω–∞—á–∞–ª–æ —Ä–∞–±–æ—Ç—ã) | –í—Å–µ–≥–æ: ${G.score}`, 'info');
        }
    }
    
    G.selected = null;
    renderCards();
    updateColumnVisuals();
    updateStats();
    updateButtons();
}

function eliminateWaste() {
    if(!G.selected?.waste) return;
    
    if (G.score < 20) {
        log(`‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –æ—á–∫–æ–≤ –¥–ª—è —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è –ø–æ—Ç–µ—Ä–∏! –ù—É–∂–Ω–æ: 20, –µ—Å—Ç—å: ${G.score}`, 'warning');
        showScoreAnimation('‚ùå');
        return;
    }
    
    const waste = G.selected.waste;
    G.selected.waste = null;
    G.wasteEliminated++;
    G.score = Math.max(0, G.score - 20);
    
    log(`üóëÔ∏è –£—Å—Ç—Ä–∞–Ω–µ–Ω–∞ –ø–æ—Ç–µ—Ä—è "${waste.name}" (-20 –æ—á–∫–æ–≤) | –í—Å–µ–≥–æ: ${G.score}`, 'success');
    showItilTip(waste.itil);
    showScoreAnimation('-20');
    
    renderCards();
    updateStats();
    updateButtons();
}

function automateProcess() {
    if(!G.selected) return;
    
    const col = G.selected.column;
    
    // Check if deploy column
    if (col === 'deploy') {
        log(`‚ùå –ö–æ–ª–æ–Ω–∫—É "–í–Ω–µ–¥—Ä–µ–Ω–∏–µ" –Ω–µ–ª—å–∑—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å!`, 'warning');
        showScoreAnimation('‚ùå');
        return;
    }
    
    const automationCost = 50 + (G.automationCount * 50);
    
    if (G.score < automationCost) {
        log(`‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –æ—á–∫–æ–≤ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏! –ù—É–∂–Ω–æ: ${automationCost}, –µ—Å—Ç—å: ${G.score}`, 'warning');
        showScoreAnimation('‚ùå');
        return;
    }
    
    if(G.automated[col]) {
        log(`–≠—Ç–∞–ø "${col}" —É–∂–µ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω`, 'warning');
        return;
    }
    
    G.automated[col] = true;
    G.automationCount++;
    G.score = Math.max(0, G.score - automationCost);
    
    log(`ü§ñ –≠—Ç–∞–ø "${col}" –ê–í–¢–û–ú–ê–¢–ò–ó–ò–†–û–í–ê–ù! –ö–∞—Ä—Ç–æ—á–∫–∏ –±—É–¥—É—Ç –ø–µ—Ä–µ–º–µ—â–∞—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∫–∞–∂–¥—ã–µ ${G.automationSpeed} —Å–µ–∫ (-2 —É—Å–∏–ª–∏—è). (-${automationCost} –æ—á–∫–æ–≤) | –í—Å–µ–≥–æ: ${G.score}`, 'success');
    log(`üí° –°–ª–µ–¥—É—é—â–∞—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –±—É–¥–µ—Ç —Å—Ç–æ–∏—Ç—å ${50 + (G.automationCount * 50)} –æ—á–∫–æ–≤`, 'info');
    showScoreAnimation(`-${automationCost}`);
    showItilTip(`ü§ñ <strong>–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–∞!</strong><br>–ü—Ä–∏–Ω—Ü–∏–ø ITIL 4 "Optimize and Automate" ‚Äî –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è —Ä—É—Ç–∏–Ω–Ω—ã—Ö –∑–∞–¥–∞—á –¥–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∏ —Å–Ω–∏–∂–µ–Ω–∏—è –æ—à–∏–±–æ–∫.<br><br>–ö–æ–ª–æ–Ω–∫–∞ –ø–æ–º–µ—á–µ–Ω–∞ –∑–Ω–∞—á–∫–æ–º ü§ñ –ê–≤—Ç–æ. –ö–∞—Ä—Ç–æ—á–∫–∏ –±—É–¥—É—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–º–µ—â–∞—Ç—å—Å—è –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π —ç—Ç–∞–ø –∫–∞–∂–¥—ã–µ ${G.automationSpeed} —Å–µ–∫—É–Ω–¥ (-2 —É—Å–∏–ª–∏—è –∑–∞ –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ).<br><br>‚ö° –ú–æ–∂–Ω–æ —É—Å–∫–æ—Ä–∏—Ç—å: -500 ‚Üí 10 —Å–µ–∫, -1500 ‚Üí 5 —Å–µ–∫!<br><br>‚ö†Ô∏è –ö–∞–∂–¥–∞—è —Å–ª–µ–¥—É—é—â–∞—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –¥–æ—Ä–æ–∂–µ –Ω–∞ +50 –æ—á–∫–æ–≤!`);
    
    updateColumnVisuals();
    updateStats();
    updateButtons();
}

function applyKaizen() {
    if(!G.selected) return;
    
    const col = G.selected.column;
    if(!G.wipLimits[col]) {
        log(`–ö–æ–ª–æ–Ω–∫–∞ "${col}" –Ω–µ –∏–º–µ–µ—Ç WIP –ª–∏–º–∏—Ç–∞`, 'warning');
        return;
    }
    
    const kaizenCost = 50;
    
    if (G.score < kaizenCost) {
        log(`‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –æ—á–∫–æ–≤ –¥–ª—è Kaizen! –ù—É–∂–Ω–æ: ${kaizenCost}, –µ—Å—Ç—å: ${G.score}`, 'warning');
        showScoreAnimation('‚ùå');
        return;
    }
    
    G.wipLimits[col]++;
    G.score = Math.max(0, G.score - kaizenCost);
    
    log(`üìà Kaizen: WIP –ª–∏–º–∏—Ç "${col}" –≤—Ä–µ–º–µ–Ω–Ω–æ —É–≤–µ–ª–∏—á–µ–Ω –¥–æ ${G.wipLimits[col]} (-${kaizenCost} –æ—á–∫–æ–≤) | –í—Å–µ–≥–æ: ${G.score}`, 'success');
    log(`‚è≥ –≠—Ñ—Ñ–µ–∫—Ç –¥–µ–π—Å—Ç–≤—É–µ—Ç –¥–æ –∫–æ–Ω—Ü–∞ –¥–Ω—è`, 'info');
    showScoreAnimation(`-${kaizenCost}`);
    showItilTip('–ü—Ä–∞–∫—Ç–∏–∫–∞ Continual Improvement ‚Äî –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–µ —É–ª—É—á—à–µ–Ω–∏–µ. Kaizen –æ–∑–Ω–∞—á–∞–µ—Ç "–∏–∑–º–µ–Ω–µ–Ω–∏–µ –∫ –ª—É—á—à–µ–º—É" ‚Äî –º–∞–ª–µ–Ω—å–∫–∏–µ —É–ª—É—á—à–µ–Ω–∏—è –∫–∞–∂–¥—ã–π –¥–µ–Ω—å.<br><br>‚è≥ <strong>–í—Ä–µ–º–µ–Ω–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç:</strong> WIP –ª–∏–º–∏—Ç —É–≤–µ–ª–∏—á–µ–Ω –¥–æ –∫–æ–Ω—Ü–∞ —Ç–µ–∫—É—â–µ–≥–æ –¥–Ω—è, –∑–∞—Ç–µ–º –≤–µ—Ä–Ω–µ—Ç—Å—è –∫ –±–∞–∑–æ–≤–æ–º—É –∑–Ω–∞—á–µ–Ω–∏—é.');
    
    updateStats();
}

function apply5S() {
    if(!G.selected) return;
    
    const col = G.selected.column;
    const cleaned = G.cards.filter(c=>c.column===col && c.waste).length;
    
    if (cleaned === 0) {
        log(`üßπ 5S –≤ "${col}": –Ω–µ—Ç –ø–æ—Ç–µ—Ä—å –¥–ª—è —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è! –ö–æ–ª–æ–Ω–∫–∞ —É–∂–µ —á–∏—Å—Ç–∞—è.`, 'info');
        return;
    }
    
    const totalCost = 30 + (cleaned * 10); // 30 –±–∞–∑–æ–≤—ã—Ö + 10 –∑–∞ –∫–∞–∂–¥—É—é –ø–æ—Ç–µ—Ä—é
    
    if (G.score < totalCost) {
        log(`‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –æ—á–∫–æ–≤ –¥–ª—è 5S! –ù—É–∂–Ω–æ: ${totalCost} (30 –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è + ${cleaned}√ó10 —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ), –µ—Å—Ç—å: ${G.score}`, 'warning');
        showScoreAnimation('‚ùå');
        return;
    }
    
    G.cards.filter(c=>c.column===col && c.waste).forEach(card => {
        card.waste = null;
        G.wasteEliminated++;
    });
    
    G.score = Math.max(0, G.score - totalCost);
    
    log(`üßπ 5S –≤ "${col}": —É—Å—Ç—Ä–∞–Ω–µ–Ω–æ ${cleaned} –ø–æ—Ç–µ—Ä—å! (-${totalCost} –æ—á–∫–æ–≤: 30 –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è + ${cleaned}√ó10 —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ) | –í—Å–µ–≥–æ: ${G.score}`, 'success');
    log(`‚ú® –ö–æ–ª–æ–Ω–∫–∞ "${col}" –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω–∞ –∏ –æ—á–∏—â–µ–Ω–∞ –æ—Ç –≤—Å–µ—Ö –ø–æ—Ç–µ—Ä—å!`, 'success');
    showScoreAnimation(`-${totalCost}`);
    showItilTip('üßπ <strong>5S –º–µ—Ç–æ–¥ –ø—Ä–∏–º–µ–Ω—ë–Ω!</strong><br>–ú–µ—Ç–æ–¥–æ–ª–æ–≥–∏—è 5S: –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞, –°–æ–±–ª—é–¥–µ–Ω–∏–µ –ø–æ—Ä—è–¥–∫–∞, –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ –≤ —á–∏—Å—Ç–æ—Ç–µ, –°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏—è, –°–æ–≤–µ—Ä—à–µ–Ω—Å—Ç–≤–æ–≤–∞–Ω–∏–µ.<br><br>–°–≤—è–∑—å —Å ITIL: –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è —Ä–∞–±–æ—á–µ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ –∏ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤. –í—Å–µ –ø–æ—Ç–µ—Ä–∏ –≤ –∫–æ–ª–æ–Ω–∫–µ —É—Å—Ç—Ä–∞–Ω–µ–Ω—ã –æ–¥–Ω–∏–º –¥–µ–π—Å—Ç–≤–∏–µ–º!<br><br>–°—Ç–æ–∏–º–æ—Å—Ç—å: 30 (–æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è) + –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–ø–æ—Ç–µ—Ä—å √ó 10 (—É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ).');
    
    renderCards();
    updateStats();
    updateButtons();
}

function speedUpAutomation() {
    let cost, newSpeed, speedText;
    
    if (G.automationSpeed === 20) {
        cost = 500;
        newSpeed = 10;
        speedText = '10 —Å–µ–∫—É–Ω–¥';
    } else if (G.automationSpeed === 10) {
        cost = 1500;
        newSpeed = 5;
        speedText = '5 —Å–µ–∫—É–Ω–¥';
    } else {
        log(`‚ö° –°–∫–æ—Ä–æ—Å—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ —É–∂–µ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è (5 —Å–µ–∫—É–Ω–¥)!`, 'info');
        return;
    }
    
    // Check if there are any automated columns
    if (Object.keys(G.automated).length === 0) {
        log(`‚ùå –°–Ω–∞—á–∞–ª–∞ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä—É–π—Ç–µ —Ö–æ—Ç—è –±—ã –æ–¥–Ω—É –∫–æ–ª–æ–Ω–∫—É!`, 'warning');
        return;
    }
    
    if (G.score < cost) {
        log(`‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –æ—á–∫–æ–≤ –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è! –ù—É–∂–Ω–æ: ${cost}, –µ—Å—Ç—å: ${G.score}`, 'warning');
        showScoreAnimation('‚ùå');
        return;
    }
    
    G.score = Math.max(0, G.score - cost);
    G.automationSpeed = newSpeed;
    
    log(`‚ö° –£–°–ö–û–†–ï–ù–ò–ï! –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∂–¥—ã–µ ${speedText}! (-${cost} –æ—á–∫–æ–≤) | –í—Å–µ–≥–æ: ${G.score}`, 'success');
    showScoreAnimation(`-${cost}`);
    showItilTip(`‚ö° <strong>–£—Å–∫–æ—Ä–µ–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–æ!</strong><br>–ü—Ä–∏–Ω—Ü–∏–ø ITIL 4 "Optimize and Automate" ‚Äî –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–µ —Å–æ–≤–µ—Ä—à–µ–Ω—Å—Ç–≤–æ–≤–∞–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤.<br><br>–ù–æ–≤–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å: –∫–∞–∂–¥—ã–µ ${speedText}<br>–≠—Ç–æ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –ø—Ä–æ–ø—É—Å–∫–Ω—É—é —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –≤—Å–µ—Ö –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∫–æ–ª–æ–Ω–æ–∫!`);
    
    updateButtons();
}

function highlightWaste(wasteId) {
    const waste = WASTE_TYPES.find(w=>w.id===wasteId);
    if(waste) showItilTip(waste.itil);
}

// Timer
function startTimer() {
    if (G.timerInterval) clearInterval(G.timerInterval);
    
    G.timerInterval = setInterval(() => {
        if (!G.running) return;
        
        G.dayTimeLeft--;
        updateStats();
        
        // Auto-move in automated columns (–∫–∞–∂–¥—ã–µ automationSpeed —Å–µ–∫—É–Ω–¥)
        if (G.dayTimeLeft % G.automationSpeed === 0) {
            Object.keys(G.automated).forEach(col => {
                const cards = G.cards.filter(c=>c.column===col);
                if(cards.length > 0 && Math.random() < 0.7) {
                    const card = cards[0];
                    const idx = COLUMNS.indexOf(col);
                    const nextCol = COLUMNS[idx + 1];
                    if(nextCol && (!G.wipLimits[nextCol] || G.cards.filter(c=>c.column===nextCol).length < G.wipLimits[nextCol])) {
                        // Check if we have enough score for automated move
                        if (G.score < 2) {
                            log(`‚ö†Ô∏è –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞: –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –æ—á–∫–æ–≤ (–Ω—É–∂–Ω–æ 2)`, 'warning');
                            return;
                        }
                        
                        card.column = nextCol;
                        card.daysInColumn = 0;
                        G.score = Math.max(0, G.score - 2);
                        log(`ü§ñ –ê–≤—Ç–æ: ${card.title} ‚Üí "${nextCol}" (-2 —É—Å–∏–ª–∏—è) | –í—Å–µ–≥–æ: ${G.score}`, 'info');
                        renderCards();
                        updateStats();
                    }
                }
            });
        }
        
        // –í—Ä–µ–º—è –≤—ã—à–ª–æ - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ—Ö–æ–¥ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É –¥–Ω—é
        if (G.dayTimeLeft <= 0) {
            log(`‚è∞ –í—Ä–µ–º—è –¥–Ω—è –∏—Å—Ç–µ–∫–ª–æ! –ü–µ—Ä–µ—Ö–æ–¥ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É –¥–Ω—é.`, 'warning');
            nextDay();
        }
    }, 1000);
}

function stopTimer() {
    if (G.timerInterval) {
        clearInterval(G.timerInterval);
        G.timerInterval = null;
    }
}

// Next Day
function nextDay() {
    if (!G.running) return;
    
    stopTimer();
    
    G.day++;
    
    // –°–±—Ä–æ—Å Kaizen —É–ª—É—á—à–µ–Ω–∏–π –∫ –±–∞–∑–æ–≤—ã–º WIP –ª–∏–º–∏—Ç–∞–º
    const hadKaizenBoosts = Object.keys(G.wipLimits).some(col => G.wipLimits[col] > G.baseWipLimits[col]);
    if (hadKaizenBoosts) {
        G.wipLimits = {...G.baseWipLimits};
        log(`‚è≥ Kaizen —ç—Ñ—Ñ–µ–∫—Ç—ã —Å–±—Ä–æ—à–µ–Ω—ã. WIP –ª–∏–º–∏—Ç—ã –≤–æ–∑–≤—Ä–∞—â–µ–Ω—ã –∫ –±–∞–∑–æ–≤—ã–º –∑–Ω–∞—á–µ–Ω–∏—è–º.`, 'info');
    }
    
    // –®—Ç—Ä–∞—Ñ –∑–∞ –æ—Å—Ç–∞–≤—à–∏–µ—Å—è –∫–∞—Ä—Ç–æ—á–∫–∏ —Å –ø–æ—Ç–µ—Ä—è–º–∏
    const cardsWithWaste = G.cards.filter(c=>c.waste && c.column!=='done').length;
    if (cardsWithWaste > 0) {
        const penalty = cardsWithWaste * 5;
        G.score = Math.max(0, G.score - penalty);
        log(`‚ö†Ô∏è –®—Ç—Ä–∞—Ñ –∑–∞ ${cardsWithWaste} –ø–æ—Ç–µ—Ä—å (-${penalty} –æ—á–∫–æ–≤)`, 'warning');
    }
    
    // –ë–æ–Ω—É—Å –∑–∞ –¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–µ –∫–∞—Ä—Ç–æ—á–∫–∏
    const delivered = G.cards.filter(c=>c.column==='done' && c.dayDelivered === G.day - 1).length;
    if (delivered > 0) {
        const bonus = delivered * 15;
        G.score += bonus;
        log(`üéâ –ë–æ–Ω—É—Å –∑–∞ ${delivered} –¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã—Ö –∑–∞–¥–∞—á (+${bonus} –æ—á–∫–æ–≤)`, 'success');
    }
    
    // Age cards
    G.cards.forEach(card => {
        if(card.column !== 'done') card.daysInColumn++;
    });
    
    // Add new cards to backlog every day
    const newCardsCount = G.day >= 5 ? 20 : 10; // 10 –∫–∞—Ä—Ç–æ—á–µ–∫ (–¥–Ω–∏ 1-4), 20 –∫–∞—Ä—Ç–æ—á–µ–∫ (–¥–µ–Ω—å 5+)
    for (let i = 0; i < newCardsCount; i++) {
        createCard();
    }
    log(`üì• ${newCardsCount} –Ω–æ–≤—ã—Ö –∑–∞–¥–∞—á –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ Backlog`, 'info');
    
    // Highlight backlog column briefly
    const backlogCol = document.querySelector('[data-col="backlog"]');
    if (backlogCol) {
        backlogCol.style.boxShadow = '0 0 20px rgba(57, 197, 207, 0.5)';
        backlogCol.style.transition = 'box-shadow 0.5s';
        setTimeout(() => {
            backlogCol.style.boxShadow = '';
        }, 1500);
    }
    
    // Random waste appears
    G.cards.filter(c=>!c.waste && c.column!=='done' && c.column!=='backlog').forEach(card => {
        if(Math.random() < 0.2) {
            card.waste = rnd(WASTE_TYPES);
            log(`‚ö†Ô∏è –ü–æ—Ç–µ—Ä—è "${card.waste.name}" –ø–æ—è–≤–∏–ª–∞—Å—å –Ω–∞ –∑–∞–¥–∞—á–µ TASK-${card.id}`, 'waste');
        }
    });
    
    // Move cards from backlog
    const backlog = G.cards.filter(c=>c.column==='backlog');
    if(backlog.length > 0) {
        const analysisCount = G.cards.filter(c=>c.column==='analysis').length;
        if(analysisCount < G.wipLimits.analysis) {
            backlog[0].column = 'analysis';
            backlog[0].daysInColumn = 0;
        }
    }
    
    log(`üìÖ –î–µ–Ω—å ${G.day} –Ω–∞—á–∞–ª—Å—è!`, 'info');
    
    renderCards();
    updateColumnVisuals();
    updateStats();
    
    if(G.day >= G.maxDays) {
        endGame();
        return;
    }
    
    // Reset timer for new day
    G.dayTimeLeft = 120;
    updateStats();
    startTimer();
}

function startGame() {
    if(G.running) return;
    
    G = {
        day: 1, maxDays: 20, score: 50, wasteEliminated: 0, delivered: 0,
        cards: [], cardCounter: 0, selected: null, running: true,
        wipLimits: {...WIP_LIMITS}, 
        baseWipLimits: {...WIP_LIMITS},
        automated: {}, automationCount: 0,
        automationSpeed: 20,
        dayTimeLeft: 120, timerInterval: null
    };
    
    // Initial cards
    for(let i=0; i<10; i++) createCard();
    
    document.getElementById('startBtn').disabled = true;
    document.getElementById('nextDayBtn').disabled = false;
    document.getElementById('log').innerHTML = '';
    log('üéÆ –ò–≥—Ä–∞ –Ω–∞—á–∞–ª–∞—Å—å! –£ –≤–∞—Å 2 –º–∏–Ω—É—Ç—ã –Ω–∞ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å.', 'success');
    log('üí∞ –°—Ç–∞—Ä—Ç–æ–≤—ã–π –∫–∞–ø–∏—Ç–∞–ª: 50 –æ—á–∫–æ–≤ –¥–ª—è –Ω–∞—á–∞–ª–∞ —Ä–∞–±–æ—Ç—ã', 'success');
    log('üí° –£–ø—Ä–∞–≤–ª—è–π—Ç–µ –∫–∞—Ä—Ç–æ—á–∫–∞–º–∏, —É—Å—Ç—Ä–∞–Ω—è–π—Ç–µ –ø–æ—Ç–µ—Ä–∏, –∑–∞—Ä–∞–±–∞—Ç—ã–≤–∞–π—Ç–µ –æ—á–∫–∏!', 'info');
    log('üì• –ù–∞—á–∞–ª—å–Ω—ã–π Backlog: 10 –∑–∞–¥–∞—á. –î–Ω–∏ 1-4: +10 –∑–∞–¥–∞—á, –î–µ–Ω—å 5+: +20 –∑–∞–¥–∞—á –∫–∞–∂–¥—ã–π –¥–µ–Ω—å.', 'info');
    log('üÜì –ù–∞—á–∞–ª–æ —Ä–∞–±–æ—Ç—ã –∏–∑ Backlog: 0 —É—Å–∏–ª–∏–π (–±–µ—Å–ø–ª–∞—Ç–Ω–æ)', 'success');
    log('‚ö° –ü–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ –º–µ–∂–¥—É —ç—Ç–∞–ø–∞–º–∏: –ë–µ–∑ –ø–æ—Ç–µ—Ä—å -2, –° –ø–æ—Ç–µ—Ä–µ–π -7 —É—Å–∏–ª–∏–π!', 'warning');
    log('üíé –°—Ç—Ä–∞—Ç–µ–≥–∏—è: –£—Å—Ç—Ä–∞–Ω—è–π—Ç–µ –ø–æ—Ç–µ—Ä–∏ (-20) + –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ (-2) = -22 –ø—Ä–æ—Ç–∏–≤ -7 –∑–∞ –¥–≤–∏–∂–µ–Ω–∏–µ —Å –ø–æ—Ç–µ—Ä–µ–π. –ï—Å–ª–∏ –∑–∞–¥–∞—á–∞ –ø—Ä–æ—Ö–æ–¥–∏—Ç 5+ —ç—Ç–∞–ø–æ–≤!', 'success');
    log('‚ö†Ô∏è –ù–µ–ª—å–∑—è —Ä–∞—Å—Ö–æ–¥–æ–≤–∞—Ç—å –æ—á–∫–∏ –ø—Ä–∏ –±–∞–ª–∞–Ω—Å–µ 0! –°–ª–µ–¥–∏—Ç–µ –∑–∞ –±–∞–ª–∞–Ω—Å–æ–º.', 'warning');
    log('ü§ñ –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è (50/100/150...): –∫–æ–ª–æ–Ω–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–º–µ—â–∞–µ—Ç –∫–∞—Ä—Ç–æ—á–∫–∏ –∫–∞–∂–¥—ã–µ 20 —Å–µ–∫ (-2 —É—Å–∏–ª–∏—è).', 'info');
    log('‚ö° –£—Å–∫–æ—Ä–µ–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏: -500 ‚Üí 10 —Å–µ–∫, -1500 ‚Üí 5 —Å–µ–∫ (—Ç—É—Ä–±–æ!)', 'info');
    log('üìà Kaizen (-50): –≤—Ä–µ–º–µ–Ω–Ω–æ +1 –∫ WIP –ª–∏–º–∏—Ç—É –¥–æ –∫–æ–Ω—Ü–∞ –¥–Ω—è', 'info');
    log('üö´ –í–Ω–µ–¥—Ä–µ–Ω–∏–µ –Ω–µ–ª—å–∑—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å!', 'warning');
    log('üßπ 5S –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è: —É—Å—Ç—Ä–∞–Ω—è–µ—Ç –í–°–ï –ø–æ—Ç–µ—Ä–∏ —Ä–∞–∑–æ–º (30 + –∫–æ–ª-–≤–æ√ó10). –≠–∫–æ–Ω–æ–º–∏—è –≤—Ä–µ–º–µ–Ω–∏!', 'info');
    
    renderCards();
    updateColumnVisuals();
    updateStats();
    startTimer();
}

function resetGame() {
    stopTimer();
    G.running = false;
    G = {
        day: 0, maxDays: 20, score: 0, wasteEliminated: 0, delivered: 0,
        cards: [], cardCounter: 0, selected: null, running: false,
        wipLimits: {...WIP_LIMITS}, 
        baseWipLimits: {...WIP_LIMITS},
        automated: {}, automationCount: 0,
        automationSpeed: 20,
        dayTimeLeft: 120, timerInterval: null
    };
    
    document.getElementById('startBtn').disabled = false;
    document.getElementById('nextDayBtn').disabled = true;
    COLUMNS.forEach(col => document.getElementById(`col-${col}`).innerHTML = '');
    document.getElementById('log').innerHTML = '';
    updateStats();
    updateButtons();
}

function endGame() {
    stopTimer();
    G.running = false;
    
    document.getElementById('nextDayBtn').disabled = true;
    
    const eff = Math.round((G.wasteEliminated / Math.max(G.wasteEliminated + G.cards.filter(c=>c.waste).length, 1)) * 100);
    
    document.getElementById('fDelivered').textContent = G.delivered;
    document.getElementById('fWaste').textContent = G.wasteEliminated;
    document.getElementById('fEfficiency').textContent = eff + '%';
    document.getElementById('fScore').textContent = G.score;
    
    log('üèÅ –ò–≥—Ä–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞! –§–∏–Ω–∞–ª—å–Ω—ã–π —Å—á–µ—Ç: ' + G.score, 'success');
    
    document.getElementById('gameOver').style.display = 'flex';
}

function showRules() { document.getElementById('rulesModal').style.display = 'block'; }
function closeRules() { document.getElementById('rulesModal').style.display = 'none'; }

window.onclick = e => { if(e.target.className==='modal') e.target.style.display='none'; }
</script>
</body>
</html>


